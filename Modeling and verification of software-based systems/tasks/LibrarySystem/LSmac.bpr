<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<org.eventb.core.prFile version="1">
<org.eventb.core.prProof name="INITIALISATION/inv1/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="" org.eventb.core.prSets="WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p1">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p1" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p2">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p2" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="wait_list'" org.eventb.core.type="WAITER"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="wait_list'∈WAITER"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="wait_list'∈{x⦂WAITER·x∈WAITER ∣ x}"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book/grd1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p3"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p4"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p6">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p6" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p7">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p7" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p8">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p8" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈BOOK∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p0" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p0"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with count=book_count_arr(book)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p16">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p15"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p16" org.eventb.core.prHyps="p3,p6,p7,p9,p5,p4,p1,p10,p2,p8,p15">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_count_arr{book ↦ count − 1}∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book_count∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="waiter_priority∈WAITER ↠ ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr{book ↦ book_count_arr(book) − 1}∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="count≥2"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈BOOK∧reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr(book)≥2"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv3/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p0" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p0"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book/inv3/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p18"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p17"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with count=book_count_arr(book)" org.eventb.core.prHyps="p7">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p13" org.eventb.core.prInfHyps="p19"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with book_set=reader_loaned_arr(reader)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p11">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p20">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p20" org.eventb.core.prHyps="p8,p3,p12,p14,p10,p9,p5,p7,p4,p2,p13,p11,p6,p1,p19">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_set" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader_loaned_arr{reader ↦ book_set∪{book}}∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book_count∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="waiter_priority∈WAITER ↠ ℕ1"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_set=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="count≥2"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book∈BOOK∧reader∈READER"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_count_arr(book)≥2"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader_loaned_arr{reader ↦ reader_loaned_arr(reader)∪{book}}∈READER → ℙ(BOOK)"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book/act2/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p6"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p4"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p7">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p9"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p7" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p5">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p5" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)∧reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈BOOK∧reader∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="count≥2"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book_count_arr(book)≥2"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="READER"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book/grd3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p6"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p4"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p7">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p9"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p7" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p5">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p5" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)∧reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈BOOK∧reader∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="count≥2"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book_count_arr(book)≥2"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="READER"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/grd1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p12" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/grd3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p12" org.eventb.core.prInfHyps="p13"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p8">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p8" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p14">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p14" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p15">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p15" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)∧reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="READER"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p33"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34,p35"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p40,p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p43"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44,p45"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p38"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p45"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p52">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p16">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p32" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p32,p46"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="p5,p17,p22,p9,p11,p27,p19,p23,p10,p14,p28,p26,p1,p6,p18,p25,p20,p24,p16,p13,p3,p32,p2,p34,p35,p37,p39,p40,p41,p42,p43,p44,p46,p47,p48,p51,p53,p54">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="¬book∈_user_books"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∉dom(waiter_priority)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∉_user_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_count_arr{book ↦ _count − 1}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="book_count_arr{book ↦ book_count_arr(book) − 1}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/inv3/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p33"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34,p35"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p40,p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p43"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44,p45"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p38"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p45"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p16">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p54">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p32" org.eventb.core.prInfHyps="p52"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p32,p46"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p5,p17,p22,p9,p11,p27,p19,p23,p10,p14,p28,p26,p1,p6,p18,p25,p20,p24,p16,p13,p3,p32,p2,p34,p35,p37,p39,p40,p41,p42,p43,p44,p46,p47,p48,p51,p52,p53">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="¬book∈_user_books"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader_loaned_arr{reader ↦ _user_books∪{book}}∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∉dom(waiter_priority)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="reader_loaned_arr{reader ↦ reader_loaned_arr(reader)∪{book}}∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∉_user_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/grd5/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="w" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p15">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p15" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p16">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p16" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p17">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees w)" org.eventb.core.prGoal="p17" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p18">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p4">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p12" org.eventb.core.prInfHyps="p21"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p18" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p22">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p22" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p23">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p23" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p24">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="p3"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees w)" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p27">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p4">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p12" org.eventb.core.prInfHyps="p21"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_book(w)=book" org.eventb.core.prHyps="p27">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p4" org.eventb.core.prInfHyps="p30"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p31"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p20" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="FORWARD_INF3" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p33"/>
<org.eventb.core.prHypAction name="DESELECT4" org.eventb.core.prHyps="p4,p9,p20,p21"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p22">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p22" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p23">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p23" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p34">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p2"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∉_user_books"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="¬book∈_user_books"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="¬waiter_book(w)∈reader_loaned_arr(reader)">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∀w⦂WAITER·waiter_book(w)=book⇒w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="w∈dom(waiter_reader)">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="waiter_book(w)∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="book_count_arr(waiter_book(w))&gt;1">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_book(w)=book⇒w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀w⦂WAITER·w∈WAITER⇒w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(w)=book⇒w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="(∀w⦂WAITER·w∈dom(waiter_book))∧waiter_book∈WAITER ⇸ BOOK∧(∀w⦂WAITER·waiter_book(w)=book⇒w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="_count=book_count_arr(waiter_book(w))">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀w⦂WAITER·⊤⇒w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(w)=book⇒w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀w⦂WAITER·w∈dom(waiter_book)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="waiter_book(w)=book">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="w∈WAITER">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="w∈dom(waiter_book)">
<org.eventb.core.prIdent name="w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="WAITER"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.he:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv5/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p5,p2,p7,p3,p6,p4,p1,p10,p11,p13">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="(∅ ⦂ ℙ(WAITER×BOOK))∈WAITER ⇸ init_books"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="inv6/THM" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prHyps="">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p0"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p0" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p0"/>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add new book/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p4,p1,p6,p2,p9,p8,p3,p5,p10">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_count_arr{book ↦ count}∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="¬book∈available_books"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="init_count_books∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="waiter_priority∈WAITER → ℕ"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∉available_books"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p4,p1,p8,p2,p10,p9,p3,p5,p11,p6,p13">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_count_arr{book ↦ book_count_arr(book)+count}∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="¬book∈available_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="init_count_books∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="waiter_priority∈WAITER → ℕ"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈BOOK∧book∉available_books"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book/act1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p6"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p3"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p8">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p8" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p9">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p9" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈BOOK∧book∉available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="¬book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/grd3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p7">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p7" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p11" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p12" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)∧reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="READER"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/inv3/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9,p10"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="PP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p12">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(IDS)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(IDS)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader_loaned_arr{reader ↦ reader_loaned_arr(reader) ∖ {book}}∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalPP:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/act1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p16">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p16" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))=reader_loaned_count(r)∧reader_loaned_count(r)≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)∧reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·reader_loaned_count(r)≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))=reader_loaned_count(r)">
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p31"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34,p35"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p38,p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p41"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p28" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p43"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p47"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p43"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p17">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p23" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p15">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p51">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p44" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p51" org.eventb.core.prHyps="p4,p16,p21,p8,p10,p26,p18,p22,p9,p13,p27,p25,p1,p5,p17,p24,p19,p23,p15,p12,p2,p32,p33,p35,p37,p38,p39,p40,p41,p42,p44,p45,p46,p49,p50">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="¬book∈_user_books"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∉dom(waiter_priority)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="finite(reader_loaned_arr(reader))"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∉_user_books"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/grd6/THM" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prHyps="p0,p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9,p10"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="remove ¬ in ¬(∃w·waiter_book(w)=book∧waiter_reader(w)=reader)" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="remove ¬ in ¬(waiter_book([[0]])=book∧waiter_reader([[0]])=reader)" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p3"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p4"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with count=book_count_arr(book)" org.eventb.core.prHyps="p0">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p18"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p17"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with book_set=reader_loaned_arr(reader)" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p6" org.eventb.core.prInfHyps="p19"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p6"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue=""/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_set" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="wait_list⊆WAITER">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="wait_list" org.eventb.core.type="ℙ(WAITER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀w⦂WAITER·w∈dom(waiter_book)">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀w⦂WAITER·w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(w)=book⇒w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀w⦂WAITER·waiter_book(w)=book⇒w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀w⦂WAITER·¬(waiter_book(w)=book∧waiter_reader(w)=reader)">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="¬(∃w⦂WAITER·waiter_book(w)=book∧waiter_reader(w)=reader)">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="¬book∈book_set"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∉book_set"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_set=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀w⦂WAITER·¬waiter_book(w)=book∨¬waiter_reader(w)=reader">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈BOOK∧reader∈READER"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="count≥2"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_count_arr(book)≥2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.rn"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="PP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p10">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_count_arr{book ↦ 1+book_count_arr(book)}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalPP:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/act2/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p12" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add new books/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9,p10"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="PP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p2,p13,p14">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_count_arr{book ↦ count}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="¬book∈available_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(IDS)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(IDS)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book∉available_books"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈BOOK∧count∈ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalPP:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book copies/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p3"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Z3" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R1000"/>
<org.eventb.core.prString name=".config_id" org.eventb.core.prSValue="Z3"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_count_arr{book ↦ book_count_arr(book)+count}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.smt.core.externalSMT"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book copies/act1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p6"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p7">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p7" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p8">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p8" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p9">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p9" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p12" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p12" org.eventb.core.prInfHyps="p13"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p8">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p8" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p14">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p14" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p15">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p15" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)∧reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="READER"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd5/WD" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER,WAITER" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p12" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p14">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p16"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p18,p19"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22,p19"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p24"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p8"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p2"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p27">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p16"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_book(_w)=book" org.eventb.core.prHyps="p27">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p30"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p16" org.eventb.core.prInfHyps="p33"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p31,p16,p3"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p18,p19"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22,p19"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p24"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_book(_w)=book" org.eventb.core.prHyps="p27">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p34"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p24"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p1">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p1" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="book_total_arr(waiter_book(_w))&gt;1">
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="⊤⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_w∈dom(waiter_reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book_total_arr(book)&gt;1">
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈BOOK∧reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book_count_arr(waiter_book(_w))&gt;1"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="_w∈dom(waiter_book)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="waiter_book(_w)=book"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="_count=book_count_arr(waiter_book(_w))"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="waiter_book(_w)∈available_books"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_book∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.he:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd4/WD" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p9">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="p12,p13" org.eventb.core.prInfHyps="p11"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15,p16,p17"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p18"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p9" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p21">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p23"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p21" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p23"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_w∈dom(waiter_reader)">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≤x"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="ran(_priorities)≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="_w∈WAITER">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_w∈dom(waiter_book)">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="⊤⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(⊤⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="waiter_book(_w)=book">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv8/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p0" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p0"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p12" org.eventb.core.prInfHyps="p13"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p14">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p14" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p15">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p15" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p16">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p16" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd7/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p10"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p16">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p18"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p17"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p16" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p19">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p19" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p20">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p20" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p21">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_w∈BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → ℙ(READER ↔ ℕ1)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="_w∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(ℙ(READER × ℤ))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(ℙ(READER × ℤ))"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_w∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/inv5/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="p7" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p34" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p43"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p44"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45,p46"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p48,p49"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p51" org.eventb.core.prHyps="p47,p48" org.eventb.core.prInfHyps="p52"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p52" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p53,p54,p55"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p56"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p46"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p47"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p25" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p17">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p36" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=min(ran(waiter_priority))" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_book(_w)=book" org.eventb.core.prHyps="p48">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p18" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p14" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p45" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF3" org.eventb.core.prHyps="p58" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT4" org.eventb.core.prHyps="p18,p14,p45,p58"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_reader(_w)=reader" org.eventb.core.prHyps="p49">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p59" org.eventb.core.prInfHyps="p66"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p17,p59"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p4,p11,p30,p21,p5,p28,p10,p24,p15,p8,p32,p7,p20,p18,p26,p22,p25,p14,p9,p6,p17,p13,p3,p23,p19,p27,p35,p37,p36,p1,p39,p40,p42,p44,p45,p48,p49,p50,p53,p54,p55,p58,p59,p60,p61,p62,p63,p64,p65,p66">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="book_total_arr(waiter_book(_w))&gt;1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="_w∈dom(waiter_reader)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="waiter_priority(_w)=min(ran(waiter_priority))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_total_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="_user_books=reader_loaned_arr(waiter_reader(_w))"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="{_w} ⩤ waiter_book∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℕ1"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="card(reader_loaned_arr(waiter_reader(_w)))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority))"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(WAITER×ℤ))"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="waiter_reader(_w)=reader"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="book_count_arr(waiter_book(_w))&gt;1"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="_w∈WAITER"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="_w∈dom(waiter_book)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_w∈WAITER∧waiter_book(_w)=book∧waiter_reader(_w)=reader"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="waiter_book∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="_w∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="ran(waiter_priority)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(available_books)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧⊤)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority)⇒b≤x"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book_count_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader))"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="waiter_priority(_w)=_min_priority"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="waiter_book(_w)=book"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="⊤⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(⊤⇒_w∈dom(waiter_reader))"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="_count=book_count_arr(waiter_book(_w))"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="waiter_book(_w)∈available_books"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℤ"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.he:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/inv2/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37,p38,p39,p40,p41,p42,p43,p44" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="p11" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48,p49"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p51"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p52,p53,p54"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p43" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p55"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p41" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p56,p57"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p59" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE9" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p62"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p63"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p25">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p65">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p44" org.eventb.core.prInfHyps="p66"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p68"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p37" org.eventb.core.prInfHyps="p69"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p33,p17,p37"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p68">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p69" org.eventb.core.prInfHyps="p70"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p69"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p65" org.eventb.core.prHyps="p6,p24,p31,p11,p14,p39,p26,p32,p12,p21,p40,p36,p1,p8,p25,p35,p28,p34,p18,p10,p7,p23,p16,p4,p29,p27,p2,p33,p17,p20,p19,p37,p30,p44,p3,p46,p47,p49,p51,p52,p53,p54,p55,p56,p58,p60,p61,p64,p66,p67,p68,p69,p70">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="_min_priority=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="_min_priority=min(ran(_priorities))"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_min_priority=_priorities(reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p70" org.eventb.core.predicate="waiter_priority(book)(reader)=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_new_priorities={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="ran(_priorities)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_count_arr{book ↦ _count − 1}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="book_count_arr{book ↦ book_count_arr(book) − 1}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="_new_priorities={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37,p38,p39,p40,p41,p42,p43,p44" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="p11" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48,p49"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p51"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p52,p53,p54"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p43" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p55"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p41" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p56,p57"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p59" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE9" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p62"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p63"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p25">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p44" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p66"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p37" org.eventb.core.prInfHyps="p68"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p33,p17,p37"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorities={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p66">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p69">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p67">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p68" org.eventb.core.prInfHyps="p70"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p68"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p69" org.eventb.core.prHyps="p6,p24,p31,p11,p14,p39,p26,p32,p12,p21,p40,p36,p1,p8,p25,p35,p28,p34,p18,p10,p7,p23,p16,p4,p29,p27,p2,p33,p17,p20,p19,p37,p30,p44,p3,p46,p47,p49,p51,p52,p53,p54,p55,p56,p58,p60,p61,p64,p65,p66,p67,p68,p70">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="_min_priority=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="_min_priority=min(ran(_priorities))"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorities}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_min_priority=_priorities(reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="waiter_priority{book ↦ {reader} ⩤ waiter_priority(book)}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p70" org.eventb.core.predicate="waiter_priority(book)(reader)=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_new_priorities={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="ran(_priorities)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="_new_priorities={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/inv3/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37,p38,p39,p40,p41,p42,p43,p44" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="p11" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48,p49"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p51"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p52,p53,p54"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p43" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p55"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p41" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p56,p57"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p59" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE9" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p62"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p63"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p25">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p44" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p68"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p37" org.eventb.core.prInfHyps="p69"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p33,p17,p37"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p68">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p69" org.eventb.core.prInfHyps="p70"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p69"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p6,p24,p31,p11,p14,p39,p26,p32,p12,p21,p40,p36,p1,p8,p25,p35,p28,p34,p18,p10,p7,p23,p16,p4,p29,p27,p2,p33,p17,p20,p19,p37,p30,p44,p3,p46,p47,p49,p51,p52,p53,p54,p55,p56,p58,p60,p61,p64,p65,p67,p68,p69,p70">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader_loaned_arr{reader ↦ _user_books∪{book}}∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="_min_priority=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="_min_priority=min(ran(_priorities))"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="reader_loaned_arr{reader ↦ reader_loaned_arr(reader)∪{book}}∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_min_priority=_priorities(reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p70" org.eventb.core.predicate="waiter_priority(book)(reader)=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_new_priorities={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="ran(_priorities)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="_new_priorities={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add new books/inv8/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9,p10"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="PP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p2,p13,p14">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_total_arr{book ↦ count}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="¬book∈available_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(IDS)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(IDS)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book∉available_books"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈BOOK∧count∈ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalPP:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book copies/inv8/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4" org.eventb.core.prSets="BOOK" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="sl/ds" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="SELECT0" org.eventb.core.prHyps="p10,p11,p2,p12,p13,p14,p4,p6,p7"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Z3" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R1000"/>
<org.eventb.core.prString name=".config_id" org.eventb.core.prSValue="Z3"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1">
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1">
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book_total_arr{book ↦ book_total_arr(book)+count}∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="waiter_book∈WAITER → BOOK">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.smt.core.externalSMT"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.mngHyp"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book copies/act2/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p6"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p7">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p7" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p8">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p8" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p9">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p9" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/grd3/THM" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prHyps="p0" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p2,p3"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p4"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p2"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p3"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p0">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p6" org.eventb.core.prInfHyps="p7"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p6"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book∈BOOK∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/grd1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p12" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/grd2/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p9">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p6"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p9" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p12" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p14">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p14" org.eventb.core.prHyps="p3"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p15">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p15" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p17" org.eventb.core.prHyps="p16">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p17" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p18">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_book(_w)=book" org.eventb.core.prHyps="p16">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p18" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p12" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p21">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps="p2"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p22">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p22" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="p23">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_book(_w)=book" org.eventb.core.prHyps="p16">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p12" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER∧(waiter_reader(_w)=reader⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="1=book_count_arr(book)">
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_w∈dom(waiter_reader)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="⊤⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER∧(waiter_reader(_w)=reader⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER∧(waiter_reader(_w)=reader⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="1=book_count_arr(waiter_book(_w))">
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER∧(waiter_reader(_w)=reader⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book∈BOOK∧reader∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="waiter_reader(_w)=reader⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="waiter_reader(_w)=reader"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="_w∈WAITER"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈WAITER → ℕ"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="_w∈dom(waiter_book)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="waiter_book(_w)=book"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER∧(waiter_reader(_w)=reader⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_w∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℤ"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="WAITER"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.he:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/grd3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p47">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p39,p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p42"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43,p44"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p47" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p50">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _wbs=waiter_priority(book)" org.eventb.core.prGoal="p50" org.eventb.core.prHyps="p26">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p52">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="p4,p17,p21,p9,p11,p27,p18,p22,p10,p13,p28,p24,p1,p6,p25,p23,p20,p8,p5,p26,p19,p2,p15,p33,p34,p36,p38,p39,p40,p41,p42,p43,p45,p46,p51">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p53">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _wbs=waiter_priority(book)" org.eventb.core.prGoal="p53" org.eventb.core.prHyps="p26">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p54">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p4,p17,p21,p9,p11,p27,p18,p22,p10,p13,p28,p24,p1,p6,p25,p23,p20,p8,p5,p26,p19,p2,p15,p33,p34,p36,p38,p39,p40,p41,p42,p43,p45,p46,p51">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_wbs" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_wbs" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬_wbs=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_wbs)⇒b≥x"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬_wbs=(∅ ⦂ ℙ(READER×ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_wbs)⇒b≥x)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="ran(_wbs)≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_wbs)⇒b≥x)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="_new_wbs={reader} ⩤ _wbs"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="_wbs=waiter_priority(book)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="_new_wbs={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≥x"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/grd3/THM" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p21,p22,p23,p24"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p25"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p26"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p2,p10,p13,p14,p8,p16,p15,p11,p9,p7,p3,p12,p6,p4,p17,p22,p23,p24,p25">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_new_max_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="ran(waiter_priority)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="_w∈WAITER∧_w∉dom(waiter_book)∧_w∉dom(waiter_reader)∧_w∉dom(waiter_priority)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="¬_w∈dom(waiter_book)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="¬_w∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈BOOK∧reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="_new_max_priority=max(ran(waiter_priority))+1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(WAITER×ℤ))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_w∈WAITER"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="¬_w∈dom(waiter_reader)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority)⇒b≥x"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/inv5/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p29"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p27" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p24" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p35"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40,p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="p39,p40,p41" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47,p48,p49,p50"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_max_priority=max(ran(waiter_priority))+1" org.eventb.core.prHyps="p16">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p42" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with book=waiter_book(_w)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p40">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p36" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p38" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p19,p36,p38"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p2,p9,p23,p14,p3,p21,p8,p17,p10,p6,p25,p5,p13,p19,p18,p15,p7,p4,p16,p28,p30,p31,p33,p35,p36,p38,p40,p41,p42,p43,p46,p47,p48,p49,p50,p53,p54,p55,p56">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_new_max_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="_w∈dom(waiter_reader)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="waiter_book{_w ↦ waiter_book(_w)}∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book_total_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="¬book_total_arr(waiter_book(_w))=1"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="⊤⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(⊤⇒_w∈dom(waiter_reader)∧(⊤⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(WAITER×ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="_w∈WAITER"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="book_count_arr(waiter_book(_w))=1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="_w∈dom(waiter_book)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="waiter_book∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority)⇒b≥x"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="_w∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="ran(waiter_priority)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_book{_w ↦ book}∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(available_books)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(book=waiter_book(_w)⇒_w∈dom(waiter_reader)∧(reader=waiter_reader(_w)⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_new_max_priority=max(ran(waiter_priority))+1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book_count_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="reader=waiter_reader(_w)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="_new_max_priority=waiter_priority(_w)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(book=waiter_book(_w)⇒_w∈dom(waiter_reader)∧⊤∧(reader=waiter_reader(_w)⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(book=waiter_book(_w)⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER∧(reader=waiter_reader(_w)⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="book=waiter_book(_w)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_w∈WAITER∧book=waiter_book(_w)∧reader=waiter_reader(_w)∧_new_max_priority=waiter_priority(_w)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="waiter_book(_w)∈available_books"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℤ"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="max(ran(waiter_priority))+1=waiter_priority(_w)"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p34" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p43,p44,p45"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p46"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p48"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p36" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p53"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _wbs=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p17,p22"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_wbs={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p54">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p56">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_max_priority=max(ran(waiter_priority(book)))+1" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p32" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p4,p19,p24,p9,p11,p30,p20,p25,p10,p14,p31,p27,p1,p6,p28,p26,p23,p8,p5,p29,p21,p2,p17,p22,p15,p32,p37,p38,p40,p42,p43,p44,p45,p46,p47,p49,p50,p51,p54,p55,p57">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_max_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_wbs" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_wbs" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬_wbs=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="ran(_wbs)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_wbs)⇒b≥x"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="_new_max_priority=max(ran(waiter_priority(book)))+1"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ _new_wbs∪{reader ↦ _new_max_priority}}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="waiter_priority{book ↦ ({reader} ⩤ waiter_priority(book))∪{reader ↦ max(ran(waiter_priority(book)))+1}}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_new_max_priority≤max_ID"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_new_wbs={reader} ⩤ _wbs"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_new_max_priority=max(ran(_wbs))+1"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="max(ran(waiter_priority(book)))+1≤max_ID"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_wbs=waiter_priority(book)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="_new_wbs={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="waiter_priority{book ↦ ({reader} ⩤ waiter_priority(book))∪{reader ↦ _new_max_priority}}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/grd4/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p10">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p10" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p11">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p11" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p12" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv6/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p5,p2,p7,p3,p6,p4,p1,p10,p11,p13">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="(∅ ⦂ ℙ(WAITER×READER))∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/inv6/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="p7" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p34" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p43"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p44"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45,p46"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p48,p49"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p51" org.eventb.core.prHyps="p47,p48" org.eventb.core.prInfHyps="p52"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p52" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p53,p54,p55"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p56"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p46"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p47"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p25" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p17">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p36" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=min(ran(waiter_priority))" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_book(_w)=book" org.eventb.core.prHyps="p48">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p18" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p14" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p45" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF3" org.eventb.core.prHyps="p58" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT4" org.eventb.core.prHyps="p18,p14,p45,p58"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="he with waiter_reader(_w)=reader" org.eventb.core.prHyps="p49">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p59" org.eventb.core.prInfHyps="p66"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p17,p59"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p4,p11,p30,p21,p5,p28,p10,p24,p15,p8,p32,p7,p20,p18,p26,p22,p25,p14,p9,p6,p17,p13,p3,p23,p19,p27,p35,p37,p36,p1,p39,p40,p42,p44,p45,p48,p49,p50,p53,p54,p55,p58,p59,p60,p61,p62,p63,p64,p65,p66">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="book_total_arr(waiter_book(_w))&gt;1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="{_w} ⩤ waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="_w∈dom(waiter_reader)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="waiter_priority(_w)=min(ran(waiter_priority))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_total_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="_user_books=reader_loaned_arr(waiter_reader(_w))"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℕ1"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="card(reader_loaned_arr(waiter_reader(_w)))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority))"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(WAITER×ℤ))"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="waiter_reader(_w)=reader"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="book_count_arr(waiter_book(_w))&gt;1"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="_w∈WAITER"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="_w∈dom(waiter_book)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_w∈WAITER∧waiter_book(_w)=book∧waiter_reader(_w)=reader"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="waiter_book∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="_w∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="ran(waiter_priority)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(available_books)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧⊤)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER)"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority)⇒b≤x"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book_count_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(waiter_book(_w)=book⇒_w∈dom(waiter_reader))"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="waiter_priority(_w)=_min_priority"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="waiter_book(_w)=book"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="⊤⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(⊤⇒_w∈dom(waiter_reader))"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="_count=book_count_arr(waiter_book(_w))"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="waiter_book(_w)∈available_books"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℤ"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.he:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/inv6/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p29"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p27" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p24" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p35"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40,p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="p39,p40,p41" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47,p48,p49,p50"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_max_priority=max(ran(waiter_priority))+1" org.eventb.core.prHyps="p16">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p42" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with book=waiter_book(_w)" org.eventb.core.prHyps="p40">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p36" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p38" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p19,p36,p38"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with reader=waiter_reader(_w)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p41">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p2,p9,p23,p14,p3,p21,p8,p17,p10,p6,p25,p5,p13,p19,p18,p15,p7,p4,p16,p28,p30,p31,p33,p35,p36,p38,p40,p41,p42,p43,p46,p47,p48,p49,p50,p53,p54,p55,p56">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_new_max_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_w" org.eventb.core.type="WAITER"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="_w∈dom(waiter_reader)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_reader{_w ↦ reader}∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book_total_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="¬book_total_arr(waiter_book(_w))=1"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="⊤⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(⊤⇒_w∈dom(waiter_reader)∧(⊤⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="waiter_reader{_w ↦ waiter_reader(_w)}∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(WAITER×ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="_w∈WAITER"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="book_count_arr(waiter_book(_w))=1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="_w∈dom(waiter_book)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="waiter_book∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority)⇒b≥x"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="_w∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="ran(waiter_priority)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="waiter_book∈WAITER ⇸ BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(available_books)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(book=waiter_book(_w)⇒_w∈dom(waiter_reader)∧(reader=waiter_reader(_w)⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_new_max_priority=max(ran(waiter_priority))+1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book_count_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="reader=waiter_reader(_w)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="_new_max_priority=waiter_priority(_w)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(book=waiter_book(_w)⇒_w∈dom(waiter_reader)∧⊤∧(reader=waiter_reader(_w)⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="_w∈WAITER⇒_w∈dom(waiter_book)∧waiter_book∈WAITER ⇸ BOOK∧(book=waiter_book(_w)⇒_w∈dom(waiter_reader)∧waiter_reader∈WAITER ⇸ READER∧(reader=waiter_reader(_w)⇒_w∈dom(waiter_priority)∧waiter_priority∈WAITER ⇸ ℤ))"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="book=waiter_book(_w)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_w∈WAITER∧book=waiter_book(_w)∧reader=waiter_reader(_w)∧_new_max_priority=waiter_priority(_w)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="waiter_book(_w)∈available_books"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℤ"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="max(ran(waiter_priority))+1=waiter_priority(_w)"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd8/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37,p38,p39,p40,p41" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p10" org.eventb.core.prInfHyps="p42"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p40" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43,p44"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45,p46"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p48"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p49,p50,p51"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p41" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p52"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p39" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p53,p54"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p36" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p58"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p45"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p47"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p54"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p32" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p21">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p60">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p27">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p35" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p31,p15,p35"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p62">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p63" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p63"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p60" org.eventb.core.prHyps="p5,p22,p29,p10,p12,p37,p24,p30,p11,p19,p38,p34,p1,p7,p23,p33,p26,p32,p16,p9,p6,p21,p14,p3,p27,p25,p2,p31,p15,p18,p17,p35,p28,p43,p44,p46,p48,p49,p50,p51,p52,p53,p55,p56,p59,p61,p62,p63,p64">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="_min_priority=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="finite(reader_loaned_arr(reader))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="_min_priority=min(ran(_priorities))"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="_min_priority=_priorities(reader)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="waiter_priority(book)(reader)=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="_new_priorities={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="ran(_priorities)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="_new_priorities={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/grd5/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="p4" org.eventb.core.prInfHyps="p3"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p15,p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p19"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p21,p22"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p25"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p26"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p30">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p30" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="¬book_total_arr(book)=1">
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_total_arr(book)≠1">
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="inv10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p16,p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p21"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p24" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p28">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p30">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p30" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p32">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p32" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p33">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p33" org.eventb.core.prHyps="p2"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p34">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p32">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p32" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="*" org.eventb.core.prGoal="p35">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p35" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(READER)∧finite(BOOK)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="b∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ∧b∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="b∈available_books⇒b∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ∧b∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="b∈BOOK">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="b∈dom(book_count_arr)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="b∈available_books">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="∀r⦂READER·⊤⇒finite(init_reader_loaned(r))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="∀r⦂READER·finite(init_reader_loaned(r))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒b∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ∧b∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="b∈dom(book_total_arr)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀r⦂READER·r∈READER⇒finite(init_reader_loaned(r))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv10/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="p7" org.eventb.core.prInfHyps="p17"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p18,p19"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20,p21"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22,p23"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22,p24,p25,p26"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22,p27"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p31"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p32">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p32" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p33">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p3,p16,p4,p7,p9,p12,p1,p5,p8,p18,p19,p21,p23,p24,p25,p26,p27,p28,p31,p33">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="b∈init_books">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="b∈init_books⇒init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀r⦂READER·⊤⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀r⦂READER·finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK·b∈init_books⇒init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/inv10/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p35"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p42,p43,p44"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p45"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p28" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p53"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p38"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE5" org.eventb.core.prHyps="p47"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p52" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p55">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p55" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p56">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p59" org.eventb.core.prHyps="p58">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prGoal="p59" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p61">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p16">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p48" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p34,p48"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prGoal="p61" org.eventb.core.prHyps="p58">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p64">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p64" org.eventb.core.prHyps="p5,p17,p22,p9,p11,p29,p19,p23,p10,p14,p30,p26,p1,p6,p27,p18,p25,p20,p24,p16,p13,p3,p34,p2,p36,p37,p39,p41,p42,p43,p44,p45,p46,p48,p49,p50,p54,p56,p58,p60,p62,p63">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p65">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p14">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p67">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p16">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p48" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p34,p48"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p67" org.eventb.core.prHyps="p5,p17,p22,p9,p11,p29,p19,p23,p10,p14,p30,p26,p1,p6,p27,p18,p25,p20,p24,p16,p13,p3,p34,p2,p36,p37,p39,p41,p42,p43,p44,p45,p46,p48,p49,p50,p54,p56,p65,p60,p62,p63">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="¬book∈_user_books"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="book_total_arr(b)≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="b∈available_books">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="∀r⦂READER·⊤⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="book_total_arr(b)≥(book_count_arr{book ↦ _count − 1})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∉dom(waiter_priority)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒book_total_arr(b)≥(book_count_arr{book ↦ _count − 1})(b)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="¬book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒book_total_arr(b)≥book_count_arr(b)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∉_user_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="b∈available_books⇒book_total_arr(b)≥(book_count_arr{book ↦ _count − 1})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="∀r⦂READER·finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="book_total_arr(book)≥book_count_arr(book) − 1"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="book_total_arr(b)≥_count − 1">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="book_total_arr(b)≥book_count_arr(book) − 1">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="book_total_arr(b)≥book_count_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∀r⦂READER·r∈READER⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/inv10/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37,p38,p39,p40,p41,p42,p43,p44,p45,p46" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="p11" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48,p49"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p51"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p52,p53"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p52,p54,p55,p56"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p52,p57"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p43" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p58,p59"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p39" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p61" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="REWRITE9" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p64"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p40" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p66"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE5" org.eventb.core.prHyps="p59"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p65" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p68">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p68" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p70" org.eventb.core.prHyps="p69">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p70" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p72" org.eventb.core.prHyps="p71">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prGoal="p72" org.eventb.core.prHyps="p25">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p74">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p73"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p75"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p46"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p76"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p77"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p38" org.eventb.core.prInfHyps="p78"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p33,p17,p38"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prGoal="p74" org.eventb.core.prHyps="p71">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p79">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p77">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p78" org.eventb.core.prInfHyps="p80"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p78"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p79" org.eventb.core.prHyps="p6,p24,p31,p11,p14,p41,p26,p32,p13,p21,p42,p36,p1,p8,p37,p25,p35,p28,p34,p18,p10,p7,p23,p16,p4,p29,p27,p2,p33,p17,p20,p19,p38,p30,p46,p3,p48,p49,p51,p53,p54,p55,p56,p57,p58,p60,p62,p63,p67,p69,p71,p73,p75,p76,p77,p78,p80">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p82" org.eventb.core.prHyps="p81">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p82" org.eventb.core.prHyps="p21">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p83">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p25">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p73"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p75"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p46"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p76"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p77"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p38" org.eventb.core.prInfHyps="p78"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p33,p17,p38"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p77">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p78" org.eventb.core.prInfHyps="p80"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p78"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p83" org.eventb.core.prHyps="p6,p24,p31,p11,p14,p41,p26,p32,p13,p21,p42,p36,p1,p8,p37,p25,p35,p28,p34,p18,p10,p7,p23,p16,p4,p29,p27,p2,p33,p17,p20,p19,p38,p30,p46,p3,p48,p49,p51,p53,p54,p55,p56,p57,p58,p60,p62,p63,p67,p69,p81,p73,p75,p76,p77,p78,p80">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p82" org.eventb.core.predicate="book_total_arr(b)≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p81" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="b∈available_books">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="∀r⦂READER·⊤⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p77" org.eventb.core.predicate="_min_priority=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p70" org.eventb.core.predicate="book_total_arr(b)≥(book_count_arr{book ↦ _count − 1})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒book_total_arr(b)≥(book_count_arr{book ↦ _count − 1})(b)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒book_total_arr(b)≥book_count_arr(b)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="_min_priority=min(ran(_priorities))"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_min_priority=_priorities(reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p75" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p71" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="b∈available_books⇒book_total_arr(b)≥(book_count_arr{book ↦ _count − 1})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="∀r⦂READER·finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p80" org.eventb.core.predicate="waiter_priority(book)(reader)=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p79" org.eventb.core.predicate="book_total_arr(book)≥book_count_arr(book) − 1"/>
<org.eventb.core.prPred name="p72" org.eventb.core.predicate="book_total_arr(b)≥_count − 1">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p74" org.eventb.core.predicate="book_total_arr(b)≥book_count_arr(book) − 1">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p83" org.eventb.core.predicate="book_total_arr(b)≥book_count_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_new_priorities={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p78" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="ran(_priorities)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p73" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r⦂READER·r∈READER⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p76" org.eventb.core.predicate="_new_priorities={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/inv10/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p10" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p39,p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p42"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43,p44"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p46"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE5" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p50">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p50" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="p51">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p53">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p53">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p55">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p55" org.eventb.core.prHyps="p5,p18,p21,p10,p12,p27,p19,p22,p11,p15,p28,p24,p1,p7,p25,p16,p14,p2,p3,p23,p20,p9,p6,p33,p34,p36,p38,p39,p40,p41,p42,p43,p45,p49,p51,p53">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p56">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p15">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p5,p18,p21,p10,p12,p27,p19,p22,p11,p15,p28,p24,p1,p7,p25,p16,p14,p2,p3,p23,p20,p9,p6,p33,p34,p36,p38,p39,p40,p41,p42,p43,p45,p49,p51,p56">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="book_total_arr(b)≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="b∈available_books">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="∀r⦂READER·⊤⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="book_total_arr(b)≥1+book_count_arr(book)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="book_total_arr(book)≥1+book_count_arr(book)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒book_total_arr(b)≥book_count_arr(b)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book_count_arr(book)+1≤book_total_arr(book)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="book_total_arr(b)≥(book_count_arr{book ↦ 1+book_count_arr(book)})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="∀r⦂READER·finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="book_total_arr(b)≥book_count_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="∀r⦂READER·r∈READER⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="b∈available_books⇒book_total_arr(b)≥(book_count_arr{book ↦ 1+book_count_arr(book)})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒book_total_arr(b)≥(book_count_arr{book ↦ 1+book_count_arr(book)})(b)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add new books/inv3/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="PP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3,p13,p14">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="¬book∈available_books"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(available_books∪{book})"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book∉available_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈BOOK∧count∈ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(available_books)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalPP:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add new books/inv5/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p21,p22"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p21,p24"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p25,p26"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3,p9,p11,p2,p4,p10,p8,p5,p14,p7,p17,p6,p1,p19,p20,p22,p24,p26,p27">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_book∈WAITER ⇸ available_books∪{book}"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="waiter_reader∈WAITER ⇸ READER"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="¬book∈available_books"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(available_books)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∉available_books"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_total_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book∈BOOK∧count∈ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈WAITER ⇸ ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book_count_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="waiter_book∈WAITER ⇸ available_books"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd9/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p6">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p6" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p18">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20,p21"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p23,p24"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prHypAction name="HIDE8" org.eventb.core.prHyps="p4"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p18" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_min_priority=_priorities(reader)⇒ran(_priorities)≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_min_priority=_priorities(reader)">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_min_priority=_priorities(reader)∧_min_priority=min(ran(_priorities))">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1⇒⊤">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="_min_priority=_priorities(reader)⇒¬_priorities=(∅ ⦂ ℙ(READER×ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_min_priority=min(ran(_priorities))">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve first book/grd1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="p4" org.eventb.core.prInfHyps="p3"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20,p21"/>
<org.eventb.core.prHypAction name="HIDE6" org.eventb.core.prHyps="p3"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p17"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1⇒⊤">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="p4" org.eventb.core.prInfHyps="p3"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p15,p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p19"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p22">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p22" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p23,p24,p25">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=init_book_reader_priority(b)" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p25" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for init_book_reader_priority(b)" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p29">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for init_book_reader_priority(b)(r)" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p28">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p28"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_count_books(b)≤init_total_books(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=init_book_reader_priority(b)∧init_count_books(b)≤init_total_books(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="r∈dom(init_book_reader_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="prior=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_book_reader_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_book_reader_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="prior=init_book_reader_priority(b)∧init_count_books(b)≤init_total_books(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="inv2/THM"/>
<org.eventb.core.prProof name="loan reserved book/grd10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p6">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p6" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p18">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20,p21"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p23,p24"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p27" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE9" org.eventb.core.prHyps="p4"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p18" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_min_priority=_priorities(reader)⇒ran(_priorities)≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_min_priority=_priorities(reader)">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_min_priority=_priorities(reader)∧_min_priority=min(ran(_priorities))">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1⇒⊤">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="_min_priority=_priorities(reader)⇒¬_priorities=(∅ ⦂ ℙ(READER×ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_min_priority=min(ran(_priorities))">
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve first book/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29" org.eventb.core.prSets="BOOK,READER" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="p29,p7" org.eventb.core.prInfHyps="p31"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p28" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34,p35"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40,p36,p41,p35"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p27" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p43"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="HIDE7" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p46"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p47"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3,p14,p8,p29,p7,p9,p24,p15,p18,p5,p26,p11,p25,p21,p2,p23,p16,p1,p22,p20,p17,p6,p4,p32,p33,p34,p37,p43,p44,p45">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK·¬init_book_reader_priority(b)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧init_book_reader_priority(b)≠(∅ ⦂ ℙ(READER×ℤ))∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ {reader ↦ 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="waiter_priority≠(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="INITIALISATION/inv11/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7" org.eventb.core.prSets="BOOK,READER,WAITER" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p14">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="sl/ds" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="SELECT0" org.eventb.core.prHyps="p11,p2,p4"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="sl/ds" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="SELECT0" org.eventb.core.prHyps="p1,p3,p15,p5,p6,p8,p9"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with init_books=dom(init_count_books)" org.eventb.core.prHyps="p8">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p16"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="sl/ds" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="SELECT0" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="CVC3" org.eventb.core.prGoal="p14" org.eventb.core.prHyps="p2,p4,p1,p3,p5,p6,p8,p16,p9">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R1000"/>
<org.eventb.core.prString name=".config_id" org.eventb.core.prSValue="CVC3"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="max_loaned_books=5">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="{r⦂READER·⊤ ∣ r ↦ 0}∈READER → ℕ"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="{r⦂READER·r∈READER ∣ r ↦ 0}∈READER → ℕ"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="dom(init_count_books)=dom(init_total_books)"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.smt.core.externalSMT"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.mngHyp"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/inv11/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27,p28"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p29,p30"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p31"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p33"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p11">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p18" org.eventb.core.prInfHyps="p35"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p18"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p10">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3,p7,p23,p13,p4,p21,p6,p9,p24,p20,p22,p12,p11,p19,p14,p18,p10,p8,p2,p17,p16,p1,p27,p28,p29,p31,p32,p35,p36">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∉_user_books"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="¬book∈_user_books"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader_loaned_count{reader ↦ reader_loaned_count(reader)+1}∈READER → ℕ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ ℕ1)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book∉dom(waiter_priority)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="reader∈dom(reader_loaned_count)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="reader_loaned_count(reader)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="¬book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="reader_loaned_count∈READER → ℕ"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/act3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p22">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p23" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p25" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p25,p17"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p22" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p15">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p15" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))=reader_loaned_count(r)∧reader_loaned_count(r)≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∉_user_books"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="¬book∈_user_books"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))=reader_loaned_count(r)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∉dom(waiter_priority)">
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·reader_loaned_count(r)≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="reader∈dom(reader_loaned_count)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_count)∧reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="¬book∈dom(waiter_priority)">
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_count∈READER → ℕ"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="READER"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/inv11/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p34" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p43" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="p40" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p24">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p40" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p41" org.eventb.core.prInfHyps="p52"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p47" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p40,p41,p47"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p51">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p52" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p4,p10,p32,p21,p5,p30,p9,p16,p33,p29,p31,p20,p18,p28,p23,p27,p13,p7,p6,p17,p12,p3,p24,p22,p1,p15,p14,p26,p25,p2,p36,p37,p38,p40,p41,p44,p46,p47,p50,p51,p52,p53,p54">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≤x"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="⊤⇒¬_priorities=(∅ ⦂ ℙ(READER×ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="_min_priority=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="reader_loaned_count(reader)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="_min_priority=min(ran(_priorities))"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="_min_priority=_priorities(reader)⇒ran(_priorities)≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="_min_priority=_priorities(reader)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader_loaned_count{reader ↦ reader_loaned_count(reader)+1}∈READER → ℕ"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_min_priority=_priorities(reader)∧_min_priority=min(ran(_priorities))"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="waiter_priority(book)(reader)=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ ℕ1)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="_min_priority=_priorities(reader)⇒¬_priorities=(∅ ⦂ ℙ(READER×ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="reader∈dom(reader_loaned_count)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="reader_loaned_count∈READER → ℕ"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/act6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p8"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p21">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p23"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p25"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p15">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p15" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))=reader_loaned_count(r)∧reader_loaned_count(r)≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="card(ran(waiter_priority(book)))&gt;0">
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))=reader_loaned_count(r)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·reader_loaned_count(r)≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="reader∈dom(reader_loaned_count)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))">
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_count)∧reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_count∈READER → ℕ"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="READER"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/inv11/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p21,p22"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p23,p24"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p26"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p5,p11,p15,p2,p6,p12,p9,p16,p17,p10,p14,p1,p18,p13,p4,p8,p7,p3,p21,p22,p23">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ ℕ1)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈dom(reader_loaned_count)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader_loaned_count(reader)&gt;0"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="reader_loaned_count∈READER → ℕ"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader_loaned_count{reader ↦ reader_loaned_count(reader) − 1}∈READER → ℕ"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/act3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p6"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p16">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p16" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p17">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p17" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p18">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p18" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(reader_loaned_arr(r))=reader_loaned_count(r)∧reader_loaned_count(r)≤max_loaned_books">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·reader_loaned_count(r)≤max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="reader∈dom(reader_loaned_count)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(reader_loaned_count)∧reader_loaned_count∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·card(reader_loaned_arr(r))=reader_loaned_count(r)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="reader_loaned_count∈READER → ℕ"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="READER"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/grd4/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p16,p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20,p21"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="*" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p2"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(READER)∧finite(BOOK)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ∧book∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd11/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p10" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p34" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p43,p44,p45"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p46"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p48"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p36" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p52">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p20">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p28" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="p24">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p55">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p55" org.eventb.core.prHyps="p5,p19,p25,p10,p12,p31,p21,p26,p11,p16,p32,p30,p1,p7,p20,p29,p23,p28,p15,p9,p6,p18,p14,p3,p24,p22,p2,p27,p37,p38,p40,p42,p43,p44,p45,p46,p47,p49,p53,p54">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p56">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p20">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p28" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="p24">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p58">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p59">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p58"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="waiter_priority(book)∈READER ⤔ IDS"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(_priorities)∧_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="_new_priorities={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="waiter_priority(book)∈ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="_new_priorities={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd12/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p16,p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22,p23"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p26"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p28" org.eventb.core.prInfHyps="p29"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p30">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p30" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p31" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p32">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p32" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book copies/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p18"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3,p8,p11,p2,p4,p9,p7,p6,p12,p14,p10,p1,p5,p13,p16,p17">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="reader_loaned_count" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ ℕ1)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_count_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ (∅ ⦂ ℙ(READER×ℤ))}∈BOOK → (READER ⇸ ℕ1)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader_loaned_count∈READER → ℕ"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book_total_arr∈available_books → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(available_books)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve first book/grd3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p12" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p14">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p14" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p15">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p15" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="waiter_priority≠(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve first book/grd4/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p7"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p12">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p12" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p13">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p13" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p14">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p14" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p15">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p15" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="waiter_priority≠(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="inv10/THM" org.eventb.core.confidence="0" org.eventb.core.prFresh="i" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p2"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p16">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE5" org.eventb.core.prHyps="p2"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p17"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p18"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p16" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p19">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees i)" org.eventb.core.prGoal="p19" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p20">
<org.eventb.core.prIdent name="i" org.eventb.core.type="ℤ"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p21">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees i)" org.eventb.core.prGoal="p21" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p22">
<org.eventb.core.prIdent name="i" org.eventb.core.type="ℤ"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p23">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees i)" org.eventb.core.prGoal="p23" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24">
<org.eventb.core.prIdent name="i" org.eventb.core.type="ℤ"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀i⦂ℤ·i≥1"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="i∈IDS">
<org.eventb.core.prIdent name="i" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="i≥1">
<org.eventb.core.prIdent name="i" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="(∀i⦂ℤ·i∈IDS)∧(∀i⦂ℤ·i≥1)∧(∀i⦂ℤ·i≤max_ID)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="i≤max_ID">
<org.eventb.core.prIdent name="i" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀i⦂ℤ·i≤max_ID"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1⇒⊤"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀i⦂ℤ·i∈IDS∧i≥1∧i≤max_ID"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀i⦂ℤ·i∈IDS"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(BOOK)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/grd13/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37,p38" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p10" org.eventb.core.prInfHyps="p39"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p53">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p43"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44,p45"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44,p46,p47,p48"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44,p49"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p36" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p51"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p39" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p52"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p54"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p55"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p53" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p56">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="p27">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p60">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p30" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p30,p15"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p60" org.eventb.core.prHyps="p5,p22,p28,p10,p12,p34,p24,p29,p11,p19,p35,p33,p1,p7,p23,p32,p26,p31,p16,p9,p6,p21,p14,p3,p27,p25,p2,p30,p15,p18,p17,p40,p41,p43,p45,p46,p47,p48,p49,p50,p52,p57,p58,p59">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p61">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p61" org.eventb.core.prHyps="p27">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p62">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p30" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p30,p15"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p62" org.eventb.core.prHyps="p5,p22,p28,p10,p12,p34,p24,p29,p11,p19,p35,p33,p1,p7,p23,p32,p26,p31,p16,p9,p6,p21,p14,p3,p27,p25,p2,p30,p15,p18,p17,p40,p41,p43,p45,p46,p47,p48,p49,p50,p52,p57,p58,p59">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≤x"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="_min_priority=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="ran(_priorities)≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="_min_priority=_priorities(reader)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="_new_priorities={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="_new_priorities={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book copies/grd2/THM" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prHyps="">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p0" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p1,p2"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p11,p17,p18"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="p1,p7,p8" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p14"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(BOOK)">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="BOOK" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="normalize ids/grd1/WD" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p21">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p13,p19,p20"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="p3,p9,p10" org.eventb.core.prInfHyps="p23"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p30"/>
<org.eventb.core.prAnte name="*" org.eventb.core.prGoal="p31"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)∧¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≥x)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)∧ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≥x)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≥x"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="normalize ids/grd3/WD" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p4">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p5">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p5" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20,p21"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20,p17,p23,p24"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p25"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p27" org.eventb.core.prHyps="p7,p13,p14" org.eventb.core.prInfHyps="p28"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p17"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _current_max_id=max(ran(waiter_priority(book)))" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p31"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_current_max_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="max(ran(waiter_priority(book)))=max_ID">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)∧ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≤x)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="_current_max_id=max_ID">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≤x"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="⊤∧⊤∧⊤∧(∃b⦂ℤ·∀x⦂ℤ·x∈ran(waiter_priority(book))⇒b≤x)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_current_max_id=max(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="normalize ids/grd4/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24,p25"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26,p27"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29,p30"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p31,p32"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p31,p35,p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="p24,p28,p29" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p38"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p33"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p10">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p41">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p41" org.eventb.core.prHyps="p5,p12,p15,p2,p6,p14,p9,p7,p8,p16,p18,p11,p4,p17,p10,p3,p1,p24,p25,p26,p27,p28,p29,p30,p32,p34,p35,p36">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="finite(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="normalize ids/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p0">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p1" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p2"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p4,p5"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p10,p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p20"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="⊥"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))">
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧⊥"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.falseHyp"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="normalize ids/grd8/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p13,p19,p20"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="p3,p9,p10" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="normalize ids/grd2/WD" org.eventb.core.confidence="0" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p21">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p16"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p17,p20,p16"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="p6,p11,p12" org.eventb.core.prInfHyps="p23"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p17"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="sl/ds" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="SELECT0" org.eventb.core.prHyps="p27,p28,p29,p30,p31,p32,p33,p34,p35,p5,p8,p9,p11,p15,p18,p19"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Z3" org.eventb.core.prHyps="p19,p1,p18">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="R1000"/>
<org.eventb.core.prString name=".config_id" org.eventb.core.prSValue="Z3"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p36"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈_ids⇒b≥x)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK">
<org.eventb.core.prIdent name="WAITER" org.eventb.core.type="ℙ(WAITER)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1">
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))∧(∃b⦂ℤ·∀x⦂ℤ·x∈_ids⇒b≥x)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)">
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈_ids⇒b≥x"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1">
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1">
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.mngHyp"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.smt.core.externalSMT"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="normalize ids/grd10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p16"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p18,p19"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p18,p15,p21,p22"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="finite(IDS)">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id/grd10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p13,p19,p20"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="p3,p9,p10" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24,p25"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26,p27"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p42">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p6">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p45">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p5,p12,p14,p2,p9,p10,p15,p17,p11,p4,p16,p8,p3,p1,p6,p21,p24,p25,p26,p27,p29,p31,p32,p33,p34,p36,p38,p39,p43">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p46">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p6">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="p5,p12,p14,p2,p9,p10,p15,p17,p11,p4,p16,p8,p3,p1,p6,p21,p24,p25,p26,p27,p29,p31,p32,p33,p34,p36,p38,p39,p43">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_ids)∧finite(IDS)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="finite(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id/grd12/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p13,p19,p20"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="p3,p9,p10" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id/grd4/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25" org.eventb.core.prSets="BOOK,READER,WAITER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26,p27"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31,p32"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p24" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p33,p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p40" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="p26,p30,p31" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p43"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p45"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p33"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p17">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p13" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p46">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p48">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p39" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p48" org.eventb.core.prHyps="p3,p7,p22,p15,p4,p20,p6,p18,p5,p9,p23,p19,p2,p10,p17,p16,p1,p13,p26,p27,p28,p29,p30,p31,p32,p34,p36,p37,p38,p39,p41,p46">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_book" org.eventb.core.type="ℙ(WAITER×BOOK)"/>
<org.eventb.core.prIdent name="init_waiter_priority" org.eventb.core.type="ℙ(WAITER×ℤ)"/>
<org.eventb.core.prIdent name="init_waiter_reader" org.eventb.core.type="ℙ(WAITER×READER)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="init_waiter_book∈WAITER → BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_waiter_reader∈WAITER → READER"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_waiter_priority∈WAITER → ℕ1"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="finite(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id/grd11/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p16,p22,p23"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p24" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p25"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="p10,p28,p29" org.eventb.core.prInfHyps="p31"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p33"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p19"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p4">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p35"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p4" org.eventb.core.prHyps="p4"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p36">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p36" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p37">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p35"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p35">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p38" org.eventb.core.prInfHyps="p39"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p25" org.eventb.core.prInfHyps="p40"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p38,p25"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p40" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p41">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p42">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p41"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧⊤"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(_priorities)∧_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="waiter_priority(book)∈ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ IDS"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p48" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49,p50"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p16" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p16,p19,p24"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p47" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p46,p47"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p53">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p43" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p57" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p8,p43,p57"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p60" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p54">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p65">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p56" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p61" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p3,p56,p61"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorites={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p65" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p4,p7,p30,p20,p27,p6,p11,p31,p28,p2,p12,p5,p21,p1,p23,p16,p8,p18,p26,p19,p10,p9,p24,p3,p33,p34,p35,p36,p38,p40,p41,p42,p43,p45,p46,p47,p49,p50,p53,p54,p55,p56,p57,p59,p61,p62,p63,p64">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorites" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="_new_id∈IDS"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="_id=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_new_id∈IDS∧_new_id∉_ids"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="_new_priorites={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_new_priorites={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="waiter_priority(book)(reader) − 1∈IDS"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="_id − 1∈IDS"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬_new_id∈_ids"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_new_id=_id − 1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="¬_id − 1∈_ids"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="¬waiter_priority(book)(reader) − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _id − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_id=_priorities(reader)"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="waiter_priority{book ↦ ({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="_new_id=waiter_priority(book)(reader) − 1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="¬_id − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id/grd16/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p13,p19,p20"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="p3,p9,p10" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,priorities⦂ℙ(READER×ℤ)·priorities=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(BOOK)∧finite(READER)∧finite(IDS)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="⊤⇒⊤∧⊤"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·¬priorities(r1)=priorities(r2)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,priorities⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧priorities=init_book_reader_priority(b)∧priorities(r1)≠priorities(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (¬ a problem if max id is very big)/grd16/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p16"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p18"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p23">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p23" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (¬ a problem if max id is very big)/grd12/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p19">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p19" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (¬ a problem if max id is very big)/grd10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p21">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (¬ a problem if max id is very big)/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24,p25"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26,p27"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p42">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p6">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p45">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p5,p12,p14,p2,p9,p10,p15,p17,p11,p4,p16,p8,p3,p1,p6,p21,p24,p25,p26,p27,p29,p31,p32,p33,p34,p36,p38,p39,p43">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p46">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p6">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="p5,p12,p14,p2,p9,p10,p15,p17,p11,p4,p16,p8,p3,p1,p6,p21,p24,p25,p26,p27,p29,p31,p32,p33,p34,p36,p38,p39,p43">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_ids)∧finite(IDS)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="finite(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (¬ a problem if max id is very big)/grd11/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="p7" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27,p28"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p4">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p4" org.eventb.core.prHyps="p4"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p33">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p33" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p32">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p35" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p35,p22"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p39">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(_priorities)∧_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="waiter_priority(book)∈ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ IDS"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (¬ a problem if max id is very big)/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p48" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49,p50"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p16" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p16,p19,p24"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p47" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p46,p47"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p53">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p43" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p57" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p8,p43,p57"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p60" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p54">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p65">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p56" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p61" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p3,p56,p61"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorites={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p65" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p4,p7,p30,p20,p27,p6,p11,p31,p28,p2,p12,p5,p21,p1,p23,p16,p8,p18,p26,p19,p10,p9,p24,p3,p33,p34,p35,p36,p38,p40,p41,p42,p43,p45,p46,p47,p49,p50,p53,p54,p55,p56,p57,p59,p61,p62,p63,p64">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorites" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="_new_id∈IDS"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="_id=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_new_id∈IDS∧_new_id∉_ids"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="_new_priorites={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_new_priorites={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="waiter_priority(book)(reader) − 1∈IDS"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="_id − 1∈IDS"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬_new_id∈_ids"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_new_id=_id − 1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="¬_id − 1∈_ids"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="¬waiter_priority(book)(reader) − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _id − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_id=_priorities(reader)"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="waiter_priority{book ↦ ({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="_new_id=waiter_priority(book)(reader) − 1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="¬_id − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is very big)/grd16/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p16"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p18"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p23">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p23" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is very big)/grd12/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p19">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p19" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is very big)/grd10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p21">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is very big)/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24,p25"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26,p27"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p42">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p6">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p45">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p5,p12,p14,p2,p9,p10,p15,p17,p11,p4,p16,p8,p3,p1,p6,p21,p24,p25,p26,p27,p29,p31,p32,p33,p34,p36,p38,p39,p43">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p46">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p6">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="p5,p12,p14,p2,p9,p10,p15,p17,p11,p4,p16,p8,p3,p1,p6,p21,p24,p25,p26,p27,p29,p31,p32,p33,p34,p36,p38,p39,p43">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_ids)∧finite(IDS)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="finite(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is very big)/grd11/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="p7" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27,p28"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p4">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p4" org.eventb.core.prHyps="p4"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p33">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p33" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p32">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p35" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p35,p22"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p39">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(_priorities)∧_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="waiter_priority(book)∈ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ IDS"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is very big)/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p48" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49,p50"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p16" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p16,p19,p24"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p47" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p46,p47"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p53">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p43" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p57" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p8,p43,p57"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p60" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p54">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p65">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p56" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p61" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p3,p56,p61"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorites={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p65" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p4,p7,p30,p20,p27,p6,p11,p31,p28,p2,p12,p5,p21,p1,p23,p16,p8,p18,p26,p19,p10,p9,p24,p3,p33,p34,p35,p36,p38,p40,p41,p42,p43,p45,p46,p47,p49,p50,p53,p54,p55,p56,p57,p59,p61,p62,p63,p64">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorites" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="_new_id∈IDS"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="_id=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_new_id∈IDS∧_new_id∉_ids"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="_new_priorites={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_new_priorites={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="waiter_priority(book)(reader) − 1∈IDS"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="_id − 1∈IDS"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬_new_id∈_ids"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_new_id=_id − 1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="¬_id − 1∈_ids"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="¬waiter_priority(book)(reader) − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _id − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_id=_priorities(reader)"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="waiter_priority{book ↦ ({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="_new_id=waiter_priority(book)(reader) − 1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="¬_id − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is ¬ very big)/grd16/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p16"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p18"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p23">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p23" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is ¬ very big)/grd12/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p19">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p19" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is ¬ very big)/grd10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p21">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is ¬ very big)/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24,p25"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26,p27"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p42">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p6">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p45">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p5,p12,p14,p2,p9,p10,p15,p17,p11,p4,p16,p8,p3,p1,p6,p21,p24,p25,p26,p27,p29,p31,p32,p33,p34,p36,p38,p39,p43">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p46">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p6">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p21" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="p5,p12,p14,p2,p9,p10,p15,p17,p11,p4,p16,p8,p3,p1,p6,p21,p24,p25,p26,p27,p29,p31,p32,p33,p34,p36,p38,p39,p43">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_ids)∧finite(IDS)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="finite(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is ¬ very big)/grd11/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="p7" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27,p28"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p4">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p4" org.eventb.core.prHyps="p4"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p33">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p33" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p32">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p35" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p35,p22"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p39">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(_priorities)∧_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="waiter_priority(book)∈ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ IDS"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only problem if max id is ¬ very big)/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p48" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49,p50"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p16" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p16,p19,p24"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p47" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p46,p47"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p53">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p43" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p57" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p8,p43,p57"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p60" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p54">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p65">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p56" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p61" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p3,p56,p61"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorites={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p65" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p4,p7,p30,p20,p27,p6,p11,p31,p28,p2,p12,p5,p21,p1,p23,p16,p8,p18,p26,p19,p10,p9,p24,p3,p33,p34,p35,p36,p38,p40,p41,p42,p43,p45,p46,p47,p49,p50,p53,p54,p55,p56,p57,p59,p61,p62,p63,p64">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorites" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="_new_id∈IDS"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="_id=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_new_id∈IDS∧_new_id∉_ids"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="_new_priorites={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_new_priorites={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="waiter_priority(book)(reader) − 1∈IDS"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="_id − 1∈IDS"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬_new_id∈_ids"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_new_id=_id − 1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="¬_id − 1∈_ids"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="¬waiter_priority(book)(reader) − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _id − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_id=_priorities(reader)"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="waiter_priority{book ↦ ({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="_new_id=waiter_priority(book)(reader) − 1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="¬_id − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max id is ¬ very big)/grd16/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p3,p4"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p16"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p18"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p23">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p23" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max id is ¬ very big)/grd12/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p19">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p19" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max id is ¬ very big)/grd10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p3">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p3" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p21">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p5,p6"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p21" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max id is ¬ very big)/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25" org.eventb.core.prSets="BOOK,READER" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="p25,p6" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p24" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p32,p33"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p34" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36,p32,p37,p31"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p39" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE6" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p43">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p17">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p13" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prGoal="p43" org.eventb.core.prHyps="p44">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p46">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p38" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p38"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="p3,p14,p7,p25,p6,p8,p21,p15,p18,p5,p23,p10,p22,p19,p2,p11,p4,p16,p1,p17,p13,p28,p29,p30,p33,p38,p40,p44">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p47">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p17">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p13" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p44">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p38" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p38"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p47" org.eventb.core.prHyps="p3,p14,p7,p25,p6,p8,p21,p15,p18,p5,p23,p10,p22,p19,p2,p11,p4,p16,p1,p17,p13,p28,p29,p30,p33,p38,p40,p44">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀b⦂BOOK·¬init_book_reader_priority(b)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧init_book_reader_priority(b)≠(∅ ⦂ ℙ(READER×ℤ))∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_ids)∧finite(IDS)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="finite(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max id is ¬ very big)/grd11/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="p7" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27,p28"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p4">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p4" org.eventb.core.prHyps="p4"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p33">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p33" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p32">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p35" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p35,p22"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p39">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID∈ℕ1">
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(_priorities)∧_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="waiter_priority(book)∈ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ IDS"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max id is ¬ very big)/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34" org.eventb.core.prSets="BOOK,READER" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="p34,p7" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p43" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44,p45,p41,p46,p40"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p48" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p51"/>
<org.eventb.core.prHypAction name="HIDE7" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p53"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p24">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p20" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p25" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p17,p25,p20"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p59">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p50" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p51" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p50,p51"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p54">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p11" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p47" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p58" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p11,p47,p58"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p61" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prGoal="p59" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p57" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p62" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p57,p62,p3"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorites={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p56">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p67">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p67" org.eventb.core.prHyps="p4,p19,p8,p34,p7,p9,p30,p21,p27,p6,p32,p14,p31,p28,p2,p15,p5,p22,p1,p24,p17,p11,p18,p26,p20,p13,p12,p25,p3,p37,p38,p39,p42,p47,p49,p50,p51,p54,p55,p56,p57,p58,p60,p62,p63,p64,p65">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorites" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="_new_id∈IDS"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀b⦂BOOK·¬init_book_reader_priority(b)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="_id=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧init_book_reader_priority(b)≠(∅ ⦂ ℙ(READER×ℤ))∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_new_id∈IDS∧_new_id∉_ids"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="_new_priorites={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_new_priorites={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="waiter_priority(book)(reader) − 1∈IDS"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="_id − 1∈IDS"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="¬_new_id∈_ids"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_new_id=_id − 1"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="¬_id − 1∈_ids"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="¬waiter_priority(book)(reader) − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _id − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="_id=_priorities(reader)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="waiter_priority{book ↦ ({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="_new_id=waiter_priority(book)(reader) − 1"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="¬_id − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="inv9/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="b,r,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="p6" org.eventb.core.prInfHyps="p5"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p23">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p17,p18,p19"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p21"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p23" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b)" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p30">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p30" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b,prior)" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p32">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p32" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p33">
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p35">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p35" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p36">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p36" org.eventb.core.prHyps="p2"/>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name=")" org.eventb.core.prGoal="p37">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="*" org.eventb.core.prGoal="p38">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p38" org.eventb.core.prHyps="p3"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="*" org.eventb.core.prGoal="p39">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p40">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p40" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p43" org.eventb.core.prHyps="p33,p41,p42">
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p43" org.eventb.core.prHyps="p33">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p45">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p42" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p46">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p46"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="prior∈READER ⇸ ℤ">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="b∈dom(waiter_priority)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="b∈BOOK">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="b∈dom(book_count_arr)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)⇒b∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ∧b∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="b∈dom(book_total_arr)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="(∀b⦂BOOK·b∈dom(waiter_priority))∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)∧(∀b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)⇒b∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ∧b∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ)∧(∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior∈READER ⇸ ℤ)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="prior=waiter_priority(b)⇒b∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ∧b∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="waiter_priority(b)∈READER ⇸ ℤ">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior∈READER ⇸ ℤ">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·b∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)∧(prior=waiter_priority(b)⇒b∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ∧b∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ)∧(prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior∈READER ⇸ ℤ)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="∀b⦂BOOK·b∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="b∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ∧b∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r10" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan reserved book/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37,p38,p39,p40,p41,p42,p43,p44" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="p11" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46,p47"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48,p49"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p51"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p52,p53,p54"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p43" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50,p55"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p41" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p56,p57"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p59" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="REWRITE9" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p62"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p63"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p64">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p64" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p68" org.eventb.core.prHyps="p65,p66,p67">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (waiter_priority{book ↦ _new_priorities})(b)" org.eventb.core.prHyps="p65">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p69,p70">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p65"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_count_arr{book ↦ _count − 1})(b)" org.eventb.core.prHyps="p66">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p69,p71">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p66"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p25">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p72"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p71" org.eventb.core.prInfHyps="p73"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p34,p71"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p44" org.eventb.core.prInfHyps="p74"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p75"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p76"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p37" org.eventb.core.prInfHyps="p77"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p33,p17,p37"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prHyps="p69">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p73" org.eventb.core.prInfHyps="p78"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p73"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=_new_priorities" org.eventb.core.prGoal="p68" org.eventb.core.prHyps="p70">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p80">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p67" org.eventb.core.prInfHyps="p79"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p67"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorities={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p80" org.eventb.core.prHyps="p75">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p83">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p70" org.eventb.core.prInfHyps="p81"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p79" org.eventb.core.prInfHyps="p82"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p70,p79"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p82" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p84"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p76">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p77" org.eventb.core.prInfHyps="p85"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p77"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p83" org.eventb.core.prHyps="p6,p24,p31,p11,p14,p39,p26,p32,p12,p21,p40,p36,p1,p8,p25,p35,p28,p34,p18,p10,p7,p23,p16,p4,p29,p27,p2,p33,p17,p20,p19,p37,p30,p44,p3,p46,p47,p49,p51,p52,p53,p54,p55,p56,p58,p60,p61,p67,p69,p70,p71,p72,p73,p74,p75,p76,p77,p78,p79,p81,p84,p85">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p86,p87">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p66"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p21">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p87" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p88"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p88"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p86" org.eventb.core.prHyps="p69" org.eventb.core.prInfHyps="p89"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p89" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p90"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p90"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p86,p91">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p65"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_count_arr{book ↦ _count − 1})(b)" org.eventb.core.prHyps="p66">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p69,p71">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p66"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p91" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p92"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p92"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p69" org.eventb.core.prHyps="p86" org.eventb.core.prInfHyps="p90"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p90"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p86,p87">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p66"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p91" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p92"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p92"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p21">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p87" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p88"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p88"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p25">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p72"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p34"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p44" org.eventb.core.prInfHyps="p74"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p75"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p76"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p37" org.eventb.core.prInfHyps="p77"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p33,p17,p37"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p68" org.eventb.core.prHyps="p92">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p94">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p67" org.eventb.core.prInfHyps="p93"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p67"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _min_priority=waiter_priority(book)(reader)" org.eventb.core.prHyps="p76">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p77" org.eventb.core.prInfHyps="p85"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p77"/>
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p94" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p94" org.eventb.core.prHyps="p95">
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p94" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p94" org.eventb.core.prHyps="p96">
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)(r)" org.eventb.core.prGoal="p94" org.eventb.core.prHyps="p95">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p94" org.eventb.core.prHyps="p94">
<org.eventb.core.prRule name="r11" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p94" org.eventb.core.prHyps="p94"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_min_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader_loaned_arr∈READER ⇸ ℙ(BOOK)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p82" org.eventb.core.predicate="r∈dom({reader} ⩤ waiter_priority(book))">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="ran(waiter_priority(book))≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p70" org.eventb.core.predicate="prior=_new_priorities">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="¬_priorities=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p76" org.eventb.core.predicate="_min_priority=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_priorities)⇒b≤x"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="prior=(waiter_priority{book ↦ _new_priorities})(b)∧(book_count_arr{book ↦ _count − 1})(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="_min_priority=min(ran(_priorities))"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p89" org.eventb.core.predicate="¬⊤"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(_user_books)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p71" org.eventb.core.predicate="_count − 1≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="prior=(waiter_priority{book ↦ _new_priorities})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p95" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p73" org.eventb.core.predicate="book_count_arr(book) − 1≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p84" org.eventb.core.predicate="r∈dom(waiter_priority(book)) ∖ {reader}">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p94" org.eventb.core.predicate="waiter_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p90" org.eventb.core.predicate="⊥"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p91" org.eventb.core.predicate="prior=({book} ⩤ waiter_priority)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="ran(_priorities)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p83" org.eventb.core.predicate="({reader} ⩤ waiter_priority(book))(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p96" org.eventb.core.predicate="waiter_priority(b)∈ℙ(READER × ℤ)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p88" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p87" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p86" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p93" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p80" org.eventb.core.predicate="_new_priorities(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="reader∈dom(reader_loaned_arr)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_total_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p78" org.eventb.core.predicate="book_count_arr(book) − 1≤book_total_arr(book)"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p92" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_min_priority=_priorities(reader)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p74" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p85" org.eventb.core.predicate="waiter_priority(book)(reader)=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p81" org.eventb.core.predicate="prior={reader} ⩤ waiter_priority(book)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=(waiter_priority{book ↦ _new_priorities})(b)∧(book_count_arr{book ↦ _count − 1})(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_new_priorities={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p79" org.eventb.core.predicate="r∈dom(_new_priorities)">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="(book_count_arr{book ↦ _count − 1})(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p77" org.eventb.core.predicate="_min_priority=min(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p72" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p75" org.eventb.core.predicate="_new_priorities={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r10" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r11" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.falseHyp"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve book (add to wait list)/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p34" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p40"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p42"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p43,p44,p45"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41,p46"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p48"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p36" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p53"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p54">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p55,p56,p57">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (waiter_priority{book ↦ _new_wbs∪{reader ↦ _new_max_priority}})(b)" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p59,p60">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p55"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _wbs=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p17,p22"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prHyps="p59">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p56" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p56"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=_new_wbs∪{reader ↦ _new_max_priority}" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p60">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p65">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p57" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_wbs={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p65" org.eventb.core.prHyps="p61">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p68">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p60" org.eventb.core.prInfHyps="p66"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p64" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p60,p64"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_max_priority=max(ran(waiter_priority(book)))+1" org.eventb.core.prGoal="p68" org.eventb.core.prHyps="p62">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p72">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p69"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p66" org.eventb.core.prInfHyps="p70"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p67" org.eventb.core.prInfHyps="p71"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p31,p66,p67"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p72" org.eventb.core.prHyps="p4,p19,p24,p9,p11,p30,p20,p25,p10,p14,p32,p27,p1,p6,p28,p26,p23,p8,p5,p29,p21,p2,p17,p22,p15,p31,p37,p38,p40,p42,p43,p44,p45,p46,p47,p49,p50,p51,p56,p57,p59,p60,p61,p62,p63,p64,p66,p67,p69,p70,p71">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p73,p74">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p55"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p74" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p75"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p75"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _wbs=waiter_priority(book)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p17" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p17,p22"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="p75">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p77">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p57" org.eventb.core.prInfHyps="p76"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_max_priority=max(ran(waiter_priority(book)))+1" org.eventb.core.prHyps="p62">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p69"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p77" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p77" org.eventb.core.prHyps="p78">
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p77" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p77" org.eventb.core.prHyps="p79">
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)(r)" org.eventb.core.prGoal="p77" org.eventb.core.prHyps="p78">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p77" org.eventb.core.prHyps="p77">
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p77" org.eventb.core.prHyps="p77"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_max_priority" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_wbs" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_wbs" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬_wbs=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p73" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p76" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="(({reader} ⩤ waiter_priority(book))∪{reader ↦ _new_max_priority})(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="ran(_wbs)≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∃b⦂ℤ·∀x⦂ℤ·x∈ran(_wbs)⇒b≥x"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="_new_max_priority=max(ran(waiter_priority(book)))+1"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="r∈dom(({reader} ⩤ waiter_priority(book))∪{reader ↦ _new_max_priority})">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p71" org.eventb.core.predicate="r∈dom(({reader} ⩤ waiter_priority(book))∪{reader ↦ max(ran(waiter_priority(book)))+1})">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="book_count_arr(book)≤book_total_arr(book)"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="prior=({reader} ⩤ waiter_priority(book))∪{reader ↦ _new_max_priority}">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="_new_max_priority≤max_ID"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="prior=(waiter_priority{book ↦ _new_wbs∪{reader ↦ _new_max_priority}})(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p75" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p72" org.eventb.core.predicate="(({reader} ⩤ waiter_priority(book))∪{reader ↦ max(ran(waiter_priority(book)))+1})(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="(_new_wbs∪{reader ↦ _new_max_priority})(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p78" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p77" org.eventb.core.predicate="waiter_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="_new_wbs={reader} ⩤ _wbs"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_new_max_priority=max(ran(_wbs))+1"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="max(ran(waiter_priority(book)))+1≤max_ID"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="r∈dom(_new_wbs∪{reader ↦ _new_max_priority})">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p74" org.eventb.core.predicate="prior=({book} ⩤ waiter_priority)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="_wbs=waiter_priority(book)"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="_new_wbs={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=(waiter_priority{book ↦ _new_wbs∪{reader ↦ _new_max_priority}})(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="prior=(waiter_priority{book ↦ _new_wbs∪{reader ↦ _new_max_priority}})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p70" org.eventb.core.predicate="prior=({reader} ⩤ waiter_priority(book))∪{reader ↦ max(ran(waiter_priority(book)))+1}">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p79" org.eventb.core.predicate="waiter_priority(b)∈ℙ(READER × ℤ)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="prior=_new_wbs∪{reader ↦ _new_max_priority}">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r10" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="reserve first book/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="p,b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p44">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p29,p30"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p28" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p31,p32"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39,p38"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p27" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p44" org.eventb.core.prHyps="p38">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p46">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="p29" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p49">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47,p48"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p50"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p33"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b,p)" org.eventb.core.prGoal="p49" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p52">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p53">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p3,p7,p25,p14,p19,p5,p8,p26,p22,p2,p24,p15,p1,p23,p21,p16,p6,p4,p29,p30,p31,p32,p34,p36,p37,p38,p39,p40,p42,p43,p47,p48,p53">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="p55">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p3,p7,p25,p14,p19,p5,p8,p26,p22,p2,p24,p15,p1,p23,p21,p16,p6,p4,p29,p30,p31,p32,p34,p36,p37,p38,p39,p40,p42,p43,p47,p48,p55">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="(∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=(waiter_priority{book ↦ {reader ↦ 1}})(b))∧⊤"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="p=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="(∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=(waiter_priority{book ↦ {reader ↦ 1}})(b))∧(∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2))"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=(waiter_priority{book ↦ {reader ↦ 1}})(b)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="p=({book} ⩤ waiter_priority)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="p={reader ↦ 1}">
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=(waiter_priority{book ↦ {reader ↦ 1}})(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="p=(waiter_priority{book ↦ {reader ↦ 1}})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=waiter_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=waiter_priority(b)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="waiter_priority≠(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max id is ¬ very big)/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="p,b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p50">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p34,p35"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p33" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p43"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44,p43"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p46" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48,p49"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p50" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p52">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p55">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p51" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p53,p54"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p56"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p38"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b,p)" org.eventb.core.prGoal="p55" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p58" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p60" org.eventb.core.prHyps="p59">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p16" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p16,p19,p24"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prGoal="p60" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p48" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p49" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p48,p49"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p61">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p45" org.eventb.core.prInfHyps="p68"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p65" org.eventb.core.prInfHyps="p69"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p8,p45,p65"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p68" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p62">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p73">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p70"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p64" org.eventb.core.prInfHyps="p71"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p69" org.eventb.core.prInfHyps="p72"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p3,p64,p69"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorites={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p73" org.eventb.core.prHyps="p63">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p74">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p74" org.eventb.core.prHyps="p4,p7,p31,p20,p28,p6,p11,p32,p29,p2,p12,p5,p21,p1,p23,p16,p8,p18,p27,p19,p10,p9,p24,p3,p34,p35,p36,p37,p39,p41,p42,p43,p44,p45,p47,p48,p49,p53,p54,p59,p61,p62,p63,p64,p65,p67,p69,p70,p71,p72">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p76" org.eventb.core.prHyps="p75">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p76" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p77">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p23">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p16" org.eventb.core.prInfHyps="p61"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p24" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p16,p19,p24"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p48" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p49" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p48,p49"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p61">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p45" org.eventb.core.prInfHyps="p68"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p65" org.eventb.core.prInfHyps="p69"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p8,p45,p65"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p68" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prHyps="p62">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p70"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p64" org.eventb.core.prInfHyps="p71"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p69" org.eventb.core.prInfHyps="p72"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p3,p64,p69"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p77" org.eventb.core.prHyps="p4,p7,p31,p20,p28,p6,p11,p32,p29,p2,p12,p5,p21,p1,p23,p16,p8,p18,p27,p19,p10,p9,p24,p3,p34,p35,p36,p37,p39,p41,p42,p43,p44,p45,p47,p48,p49,p53,p54,p75,p61,p62,p63,p64,p65,p67,p69,p70,p71,p72">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorites" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="_new_id∈IDS"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="_id=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p75" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p77" org.eventb.core.predicate="p=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="p=_new_priorites∪{reader ↦ _id − 1}">
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="⊤⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="max_ID∈ℕ1⇒finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="p=(waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_new_id∈IDS∧_new_id∉_ids"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="_new_priorites={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_new_priorites={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p71" org.eventb.core.predicate="waiter_priority(book)(reader) − 1∈IDS"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=(waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="_id − 1∈IDS"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p76" org.eventb.core.predicate="p=({book} ⩤ waiter_priority)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="¬_new_id∈_ids"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀b⦂BOOK·max(ran(init_book_reader_priority(b)))≤max_ID"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⇸ IDS)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_new_id=_id − 1"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="¬_id − 1∈_ids"/>
<org.eventb.core.prPred name="p72" org.eventb.core.predicate="¬waiter_priority(book)(reader) − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="max_ID∈ℕ1∧max_ID&gt;card(BOOK)∗card(READER)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="(∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=(waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b))∧(∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2))"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_id=_priorities(reader)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=(waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b)"/>
<org.eventb.core.prPred name="p74" org.eventb.core.predicate="p=({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}">
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p73" org.eventb.core.predicate="p=_new_priorites∪{reader ↦ waiter_priority(book)(reader) − 1}">
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·p=waiter_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p70" org.eventb.core.predicate="_new_id=waiter_priority(book)(reader) − 1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=waiter_priority(b)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="p=_new_priorites∪{reader ↦ _new_id}">
<org.eventb.core.prIdent name="p" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="¬_id − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="(∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=(waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b))∧⊤"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="first reserve book (add first reservation)/grd1/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="p4" org.eventb.core.prInfHyps="p3"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p15,p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p19"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p21,p22"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p23"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p29">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="first reserve book (add first reservation)/grd3/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="p4,p5" org.eventb.core.prInfHyps="p3"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p10,p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE6" org.eventb.core.prHyps="p3"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_count_arr)∧book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="waiter_priority≠(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="first reserve book (add first reservation)/grd4/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="p4,p5" org.eventb.core.prInfHyps="p3"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p10,p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE6" org.eventb.core.prHyps="p3"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p20"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p28">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p28" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(BOOK)∧finite(READER)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="waiter_priority≠(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(book_total_arr)∧book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="READER" org.eventb.core.type="ℙ(READER)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="first reserve book (add first reservation)/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p39,p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p42"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43,p44"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p4,p16,p20,p9,p11,p27,p17,p21,p10,p13,p28,p24,p1,p6,p26,p18,p2,p25,p23,p19,p8,p5,p33,p34,p36,p38,p39,p40,p41,p42,p43,p45,p46,p47">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ {reader ↦ 1}}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="waiter_priority≠(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max_ID is small)/grd16/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p2" org.eventb.core.prHyps="p4" org.eventb.core.prInfHyps="p3"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p6,p7"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p15,p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p19"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p21"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p22"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p9"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p23">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="total function dom substitution in goal" org.eventb.core.prGoal="p23" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p24">
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prGoal="p24" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
<org.eventb.core.prExprRef name=".subst" org.eventb.core.prRef="e0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p26">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p26" org.eventb.core.prHyps="p1"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prExpr name="e0" org.eventb.core.expression="BOOK"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.totalDom:2"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max_ID is small)/grd12/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p6">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p6" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p20">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p11,p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p19"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p20" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(BOOK)∧⊤"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max_ID is small)/grd10/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p6">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p6" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p22">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p11,p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p21"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p22" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="⊤∧⊤"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(BOOK)∧⊤"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="book∈dom(waiter_priority)∧waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))">
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(BOOK)∧finite(READER)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈READER∧r2∈READER∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max_ID is small)/grd6/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p28"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p29,p30"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p31,p32"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p35,p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p27" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p38"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p40" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p28" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p43"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p33"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p45">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p19">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p46">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p48">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p39" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p48" org.eventb.core.prHyps="p4,p16,p20,p8,p10,p24,p17,p21,p9,p12,p25,p22,p1,p5,p13,p6,p18,p2,p19,p15,p29,p30,p32,p34,p35,p36,p37,p38,p39,p41,p42,p46">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p49">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p19">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p15" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p46">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p39" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p49" org.eventb.core.prHyps="p4,p16,p20,p8,p10,p24,p17,p21,p9,p12,p25,p22,p1,p5,p13,p6,p18,p2,p19,p15,p29,p30,p32,p34,p35,p36,p37,p38,p39,p41,p42,p46">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="finite(_ids)∧finite(IDS)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="finite(ran(waiter_priority(book)))"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max_ID is small)/grd11/WD" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="p8" org.eventb.core.prInfHyps="p7"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p17"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p19,p20,p21"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p16,p23"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p24" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p25"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p16"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∧ goal" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p4">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p4" org.eventb.core.prHyps="p4"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p33">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prGoal="p33" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p5"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p32">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p35" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p25" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p35,p25"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p39">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional goal" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p38"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="waiter_priority(book)∈READER ⤔ IDS"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="reader∈dom(_priorities)∧_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="waiter_priority(book)∈ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="waiter_priority(book)∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.conj:0"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.isFunGoal"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max_ID is small)/inv7/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p43"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p44,p45,p46"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p36" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p47"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p49" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p51,p52"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p54"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p55"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p26">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p56"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p19,p22,p27"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p61">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p51" org.eventb.core.prInfHyps="p59"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p52" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p51,p52"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p56">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p13" org.eventb.core.prInfHyps="p62"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p48" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p60" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p13,p48,p60"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p63" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prGoal="p61" org.eventb.core.prHyps="p57">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p68">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p59" org.eventb.core.prInfHyps="p66"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p64" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p3,p59,p64"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorites={reader} ⩤ waiter_priority(book)" org.eventb.core.prGoal="p68" org.eventb.core.prHyps="p58">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p69">
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p69" org.eventb.core.prHyps="p5,p21,p28,p9,p11,p33,p23,p30,p10,p16,p34,p31,p1,p6,p17,p7,p24,p2,p26,p19,p13,p20,p29,p22,p15,p14,p27,p3,p38,p39,p41,p43,p44,p45,p46,p47,p48,p50,p51,p52,p53,p56,p57,p58,p59,p60,p62,p64,p65,p66,p67">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorites" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="_new_id∈IDS"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="_id=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _id − 1}}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_new_id∈IDS∧_new_id∉_ids"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="_new_priorites={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="_new_priorites={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="waiter_priority(book)(reader) − 1∈IDS"/>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="waiter_priority{book ↦ ({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="_id − 1∈IDS"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="¬_new_id∈_ids"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_new_id=_id − 1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="¬_id − 1∈_ids"/>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="¬waiter_priority(book)(reader) − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_id=_priorities(reader)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ waiter_priority(book)(reader) − 1}}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="_new_id=waiter_priority(book)(reader) − 1"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}}∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="¬_id − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="first reserve book (add first reservation)/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p32"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p35,p36"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p38"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p39,p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p31" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p37,p42"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p29" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43,p44"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p50">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p50" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p51,p52,p53">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (waiter_priority{book ↦ {reader ↦ 1}})(b)" org.eventb.core.prHyps="p51">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p55,p56">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p52" org.eventb.core.prInfHyps="p57"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p52"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior={reader ↦ 1}" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p56">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p59">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p53" org.eventb.core.prInfHyps="p58"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p53"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p59" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p61">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p58" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p60"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p61" org.eventb.core.prHyps="p4,p16,p20,p9,p11,p27,p17,p21,p10,p13,p28,p24,p1,p6,p26,p18,p2,p25,p23,p19,p8,p5,p33,p34,p36,p38,p39,p40,p41,p42,p43,p45,p46,p47,p52,p53,p55,p56,p57,p60">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p62,p63">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p63" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p64"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p54" org.eventb.core.prHyps="p64">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p53" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p53"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p67">
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p68">
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)(r)" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p67">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p66">
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p66" org.eventb.core.prHyps="p66"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="book_total_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=(waiter_priority{book ↦ {reader ↦ 1}})(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="book_total_arr(book)≠1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="prior={reader ↦ 1}">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_count_arr∈BOOK ⇸ ℤ"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬waiter_priority=(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="book_count_arr(book)≤book_total_arr(book)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="prior=(waiter_priority{book ↦ {reader ↦ 1}})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="prior=(waiter_priority{book ↦ {reader ↦ 1}})(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="¬book_total_arr(book)=1"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="{reader ↦ 1}(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="book∈dom(book_total_arr)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="waiter_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="r=reader">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="prior=({book} ⩤ waiter_priority)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="waiter_priority≠(∅ ⦂ ℙ(BOOK×ℙ(READER×ℤ)))"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈dom(book_count_arr)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book_count_arr(book)=1"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="1∈IDS"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="r∈dom({reader ↦ 1})">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="book∈available_books∧reader∈READER"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="waiter_priority(b)∈ℙ(READER × ℤ)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r10" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="shrink waitlist id (only used if max_ID is small)/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36" org.eventb.core.prSets="BOOK,READER" org.eventb.core.psManual="true">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38,p39"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p18" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40,p41"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p43"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p44,p42,p45,p46"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p36" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p42,p47"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p32" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p49" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p51,p52"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p37" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p54"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p55"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p56">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p60" org.eventb.core.prHyps="p57,p58,p59">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b)" org.eventb.core.prHyps="p58">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p61,p62">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p58"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p26">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p19,p27,p22"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p51" org.eventb.core.prInfHyps="p66"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p52" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p62" org.eventb.core.prInfHyps="p68"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p51,p52,p62"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prHyps="p61">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p57" org.eventb.core.prInfHyps="p69"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p57"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p63">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p13" org.eventb.core.prInfHyps="p70"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p48" org.eventb.core.prInfHyps="p71"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p67" org.eventb.core.prInfHyps="p72"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p13,p48,p67"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p71" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prHyps="p64">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p73"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p66" org.eventb.core.prInfHyps="p74"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p68" org.eventb.core.prInfHyps="p75"/>
<org.eventb.core.prHypAction name="FORWARD_INF3" org.eventb.core.prHyps="p72" org.eventb.core.prInfHyps="p76"/>
<org.eventb.core.prHypAction name="DESELECT4" org.eventb.core.prHyps="p72,p3,p66,p68"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_priorites={reader} ⩤ waiter_priority(book)" org.eventb.core.prHyps="p65">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p75" org.eventb.core.prInfHyps="p77"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p75"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}" org.eventb.core.prGoal="p60" org.eventb.core.prHyps="p77">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p79">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p59" org.eventb.core.prInfHyps="p78"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p59"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p79" org.eventb.core.prHyps="p5,p21,p28,p9,p11,p33,p23,p30,p10,p16,p34,p31,p1,p6,p17,p7,p24,p2,p26,p19,p13,p20,p29,p22,p15,p14,p27,p3,p38,p39,p40,p43,p44,p45,p46,p47,p48,p50,p51,p52,p53,p57,p59,p61,p62,p63,p64,p65,p66,p67,p68,p69,p70,p72,p73,p74,p75,p76,p77,p78">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p80,p81">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p58"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p80" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p82"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p82"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _priorities=waiter_priority(book)" org.eventb.core.prHyps="p26">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p19" org.eventb.core.prInfHyps="p63"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p22" org.eventb.core.prInfHyps="p64"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p65"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p19,p27,p22"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _new_id=_id − 1" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p51" org.eventb.core.prInfHyps="p66"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p52" org.eventb.core.prInfHyps="p67"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p51,p52"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p60" org.eventb.core.prHyps="p82">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p84">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p59" org.eventb.core.prInfHyps="p83"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p59"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _ids=ran(waiter_priority(book))" org.eventb.core.prHyps="p63">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p13" org.eventb.core.prInfHyps="p70"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p48" org.eventb.core.prInfHyps="p71"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p67" org.eventb.core.prInfHyps="p72"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p13,p48,p67"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p71" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _id=waiter_priority(book)(reader)" org.eventb.core.prHyps="p64">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p3" org.eventb.core.prInfHyps="p73"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p66" org.eventb.core.prInfHyps="p74"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p72" org.eventb.core.prInfHyps="p76"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p66,p72,p3"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p84" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p84" org.eventb.core.prHyps="p85">
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p84" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p84" org.eventb.core.prHyps="p86">
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)(r)" org.eventb.core.prGoal="p84" org.eventb.core.prHyps="p85">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p84" org.eventb.core.prHyps="p84">
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p84" org.eventb.core.prHyps="p84"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_ids" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_new_id" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_new_priorites" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="_priorities" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="_new_id∈IDS"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p64" org.eventb.core.predicate="_id=waiter_priority(book)(reader)"/>
<org.eventb.core.prPred name="p81" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p83" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p70" org.eventb.core.predicate="card(ran(waiter_priority(book)))&lt;card(IDS)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="card(_ids)&lt;card(IDS)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="prior=(waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p79" org.eventb.core.predicate="(({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1})(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p77" org.eventb.core.predicate="prior=({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1}">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="finite(_ids)"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="_new_id∈IDS∧_new_id∉_ids"/>
<org.eventb.core.prPred name="p65" org.eventb.core.predicate="_new_priorites={reader} ⩤ waiter_priority(book)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="_priorities=waiter_priority(book)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="_new_priorites={reader} ⩤ _priorities"/>
<org.eventb.core.prPred name="p74" org.eventb.core.predicate="waiter_priority(book)(reader) − 1∈IDS"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="¬_ids=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="finite(IDS)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p69" org.eventb.core.predicate="book_count_arr(book)≤book_total_arr(book)"/>
<org.eventb.core.prPred name="p66" org.eventb.core.predicate="_id − 1∈IDS"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="waiter_priority(book)≠(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="¬_new_id∈_ids"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p71" org.eventb.core.predicate="¬ran(waiter_priority(book))=(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="waiter_priority∈BOOK ⇸ ℙ(READER × ℤ)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_new_id=_id − 1"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p68" org.eventb.core.predicate="prior=_new_priorites∪{reader ↦ _id − 1}">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p62" org.eventb.core.predicate="prior=_new_priorites∪{reader ↦ _new_id}">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p67" org.eventb.core.predicate="¬_id − 1∈_ids"/>
<org.eventb.core.prPred name="p82" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p76" org.eventb.core.predicate="¬waiter_priority(book)(reader) − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="reader∈dom(waiter_priority(book))"/>
<org.eventb.core.prPred name="p85" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p75" org.eventb.core.predicate="prior=_new_priorites∪{reader ↦ waiter_priority(book)(reader) − 1}">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p63" org.eventb.core.predicate="_ids=ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="_priorities∈READER ⇸ ℤ"/>
<org.eventb.core.prPred name="p84" org.eventb.core.predicate="waiter_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="reader∈dom(_priorities)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="_ids=ran(_priorities)"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="prior=(waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="_id=_priorities(reader)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p73" org.eventb.core.predicate="_new_id=waiter_priority(book)(reader) − 1"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬waiter_priority(book)=(∅ ⦂ ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p80" org.eventb.core.predicate="prior=({book} ⩤ waiter_priority)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=(waiter_priority{book ↦ _new_priorites∪{reader ↦ _new_id}})(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="_ids≠(∅ ⦂ ℙ(ℤ))"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p72" org.eventb.core.predicate="¬_id − 1∈ran(waiter_priority(book))"/>
<org.eventb.core.prPred name="p78" org.eventb.core.predicate="r∈dom(({reader} ⩤ waiter_priority(book))∪{reader ↦ waiter_priority(book)(reader) − 1})">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p86" org.eventb.core.predicate="waiter_priority(b)∈ℙ(READER × ℤ)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r10" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add new books/inv10/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="p9" org.eventb.core.prInfHyps="p25"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26,p27"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p32,p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p35"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36,p37"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p39"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p42"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prHypAction name="HIDE5" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p41" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p44">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p44" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="p45">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p48" org.eventb.core.prHyps="p47">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p48" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p49" org.eventb.core.prHyps="p47">
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prGoal="p49" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p50">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊤ goal" org.eventb.core.prGoal="p50" org.eventb.core.prHyps=""/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="p51">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p53">
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p51" org.eventb.core.prHyps="p47" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p54" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p55"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="p51">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p47">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p19">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p58">
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="p51" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p55"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p59" org.eventb.core.prHyps="p51">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p59" org.eventb.core.prHyps="p19">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p60">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p60" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p61">
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p61" org.eventb.core.prHyps="p4,p24,p6,p9,p13,p17,p2,p7,p10,p18,p19,p11,p1,p5,p12,p26,p27,p29,p31,p32,p33,p34,p35,p37,p38,p39,p43,p45,p51">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="count≥count"/>
<org.eventb.core.prPred name="p60" org.eventb.core.predicate="book_total_arr(b)≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="count≥book_count_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p59" org.eventb.core.predicate="({book} ⩤ book_total_arr)(b)≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="∀r⦂READER·⊤⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books∪{book}⇒(book_total_arr{book ↦ count})(b)≥(book_count_arr{book ↦ count})(b)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="count≥(book_count_arr{book ↦ count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒book_total_arr(b)≥book_count_arr(b)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="b∈available_books∪{book}⇒(book_total_arr{book ↦ count})(b)≥(book_count_arr{book ↦ count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="¬⊤"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="count≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="¬book∈available_books"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="({book} ⩤ book_total_arr)(b)≥count">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="book∉available_books"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book∈BOOK∧count∈ℕ1"/>
<org.eventb.core.prPred name="p58" org.eventb.core.predicate="book_total_arr(b)≥count">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="∀r⦂READER·finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="({book} ⩤ book_total_arr)(b)≥(book_count_arr{book ↦ count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="⊤"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="⊥"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p61" org.eventb.core.predicate="book_total_arr(b)≥book_count_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="b∈available_books∪{book}">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀r⦂READER·r∈READER⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="(book_total_arr{book ↦ count})(b)≥(book_count_arr{book ↦ count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.trueGoal"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.falseHyp"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book copies/inv10/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="b" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="p10" org.eventb.core.prInfHyps="p25"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26,p27"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p28,p29"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p31"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p32,p33,p34"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30,p35"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p39"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p38" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p40"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees b)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p41">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p41" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p43" org.eventb.core.prHyps="p42">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p43" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="p44">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p45" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="p44">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p46" org.eventb.core.prHyps="p4,p24,p7,p10,p14,p17,p2,p8,p11,p18,p20,p12,p1,p6,p13,p5,p19,p26,p27,p29,p31,p32,p33,p34,p35,p36,p40,p42,p44">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p48" org.eventb.core.prHyps="p47">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p48" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p49">
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="p44" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p50" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p51"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="p47">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in goal" org.eventb.core.prGoal="p52" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p53" org.eventb.core.prHyps="p44">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p53" org.eventb.core.prHyps="p20">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p54">
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="p47" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p51"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prGoal="p55" org.eventb.core.prHyps="p47">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p55" org.eventb.core.prHyps="p20">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p56">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in goal" org.eventb.core.prGoal="p56" org.eventb.core.prHyps="p18">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p57">
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ML" org.eventb.core.prGoal="p57" org.eventb.core.prHyps="p4,p24,p7,p10,p14,p17,p2,p8,p11,p18,p20,p12,p1,p6,p13,p5,p19,p26,p27,p29,p31,p32,p33,p34,p35,p36,p40,p42,p47">
<org.eventb.core.prString name=".arg" org.eventb.core.prSValue="0;1:500"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="max_ID" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="({book} ⩤ book_total_arr)(b)≥(book_count_arr{book ↦ book_count_arr(book)+count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="(book_total_arr{book ↦ book_total_arr(book)+count})(b)≥(book_count_arr{book ↦ book_count_arr(book)+count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="max_loaned_books∈ℕ1"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="b∈available_books⇒(book_total_arr{book ↦ book_total_arr(book)+count})(b)≥(book_count_arr{book ↦ book_count_arr(book)+count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="book_total_arr(b)≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="init_count_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="b∈available_books">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="available_books⊆BOOK"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="({book} ⩤ book_total_arr)(b)≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="∀r⦂READER·⊤⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="init_books=dom(init_count_books)"/>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="init_reader_loaned∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="book_total_arr(book)+count≥({book} ⩤ book_count_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="IDS=1 ‥ max_ID"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="reader_loaned_arr∈READER → ℙ(BOOK)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒book_total_arr(b)≥book_count_arr(b)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="book_total_arr(book)+count≥book_count_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="book_total_arr(book)+count≥(book_count_arr{book ↦ book_count_arr(book)+count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="init_total_books∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="book_total_arr(book)+count≥book_count_arr(book)+count"/>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="¬⊤"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)"/>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="init_books⊆BOOK"/>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧book_count_arr(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="({book} ⩤ book_total_arr)(b)≥book_count_arr(book)+count">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="init_book_reader_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="init_books=dom(init_total_books)"/>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="book_total_arr(b)≥book_count_arr(book)+count">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="book∈available_books"/>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="max_ID∈ℕ1"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="∀r⦂READER·finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS"/>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="⊥"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="max_ID&gt;card(READER)"/>
<org.eventb.core.prPred name="p57" org.eventb.core.predicate="book_total_arr(b)≥book_count_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀b⦂BOOK·b∈available_books⇒(book_total_arr{book ↦ book_total_arr(book)+count})(b)≥(book_count_arr{book ↦ book_count_arr(book)+count})(b)"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r⦂READER·r∈READER⇒finite(init_reader_loaned(r))"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)"/>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="com.clearsy.atelierb.provers.core.externalML:1"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.falseHyp"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="loan book (without wait reservation)/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3,p4" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="p7" org.eventb.core.prInfHyps="p6"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p8" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p9,p10"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p11" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p12,p13"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p14" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p16"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p17" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p18,p19,p20"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p15,p22"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p23" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24,p25"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p26" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p28" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p29"/>
<org.eventb.core.prHypAction name="REWRITE8" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p30"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p12"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p15"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p33">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p33" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p34,p35,p36">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_count_arr{book ↦ _count − 1})(b)" org.eventb.core.prHyps="p35">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p38,p39">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p4">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p40" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p39" org.eventb.core.prInfHyps="p42"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p40,p39"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p43" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p43,p27"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p34">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p47">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p36" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prGoal="p47" org.eventb.core.prHyps="p38">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p51">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p42" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p46" org.eventb.core.prInfHyps="p50"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p34,p42,p46"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p51" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p51" org.eventb.core.prHyps="p52">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)(r)" org.eventb.core.prGoal="p51" org.eventb.core.prHyps="p52">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p51" org.eventb.core.prHyps="p51">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p51" org.eventb.core.prHyps="p51"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p53,p54">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p35"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p54" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p55"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p55"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _count=book_count_arr(book)" org.eventb.core.prHyps="p4">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p40" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p40"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with _user_books=reader_loaned_arr(reader)" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p43" org.eventb.core.prInfHyps="p44"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p27" org.eventb.core.prInfHyps="p45"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p43,p27"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p34">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p47">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p36" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p47" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p47" org.eventb.core.prHyps="p56">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)(r)" org.eventb.core.prGoal="p47" org.eventb.core.prHyps="p56">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p47" org.eventb.core.prHyps="p47">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p47" org.eventb.core.prHyps="p47"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="_count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="_user_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="reader_loaned_arr" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="¬book∈_user_books"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="reader∈READER"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="_count=book_count_arr(book)"/>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="book∉dom(waiter_priority)"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="_count&gt;1"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="¬book∈dom(waiter_priority)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="book_count_arr(book) − 1≤book_total_arr(book)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="card(_user_books)&lt;max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="_count − 1≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="book∉_user_books"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p56" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧(book_count_arr{book ↦ _count − 1})(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="book_count_arr(book) − 1≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="prior=waiter_priority(b)∧(book_count_arr{book ↦ _count − 1})(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="card(reader_loaned_arr(reader))&lt;max_loaned_books">
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="waiter_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="_user_books=reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="waiter_priority(book)∈READER ⤔ IDS"/>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="prior=waiter_priority(book)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="waiter_priority(book)(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="¬book∈reader_loaned_arr(reader)"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="(book_count_arr{book ↦ _count − 1})(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="book_count_arr(book)&gt;1"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="r∈dom(waiter_priority(book))">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="return book/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p3" org.eventb.core.prHyps="p5" org.eventb.core.prInfHyps="p4"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p6" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p7,p8"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p9" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p10,p11"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p12" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p14"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p15" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p16,p17,p18"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p19" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p13,p20"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p21" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22,p23"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p24"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p25"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p26"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p10"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p13"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p27">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p27" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p28,p29,p30">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_count_arr{book ↦ 1+book_count_arr(book)})(b)" org.eventb.core.prHyps="p29">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p32,p33">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p28">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p35">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p30" org.eventb.core.prInfHyps="p34"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prGoal="p35" org.eventb.core.prHyps="p32">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p39">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p28" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p37"/>
<org.eventb.core.prHypAction name="FORWARD_INF2" org.eventb.core.prHyps="p34" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prHypAction name="DESELECT3" org.eventb.core.prHyps="p28,p33,p34"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p40">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)(r)" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p40">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p39">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p39"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p41,p42">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p43"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p31" org.eventb.core.prHyps="p28">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p35">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p30" org.eventb.core.prInfHyps="p34"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p30"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p35" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p35" org.eventb.core.prHyps="p44">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)(r)" org.eventb.core.prGoal="p35" org.eventb.core.prHyps="p44">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p35" org.eventb.core.prHyps="p35">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p35" org.eventb.core.prHyps="p35"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="1+book_count_arr(book)≤book_total_arr(book)"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="1+book_count_arr(book)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="waiter_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="reader∈READER">
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="waiter_priority(book)∈READER ⤔ IDS"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="prior=waiter_priority(book)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="waiter_priority(book)(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="prior=waiter_priority(b)∧(book_count_arr{book ↦ 1+book_count_arr(book)})(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="r∈dom(waiter_priority(book))">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧(book_count_arr{book ↦ 1+book_count_arr(book)})(b)≤book_total_arr(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="(book_count_arr{book ↦ 1+book_count_arr(book)})(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="book∈available_books∧reader∈READER">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="reader" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add new books/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="p6" org.eventb.core.prInfHyps="p5"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p17,p18,p19"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p21"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p22" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p23,p24"/>
<org.eventb.core.prHypAction name="REWRITE6" org.eventb.core.prHidden="p25" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p26"/>
<org.eventb.core.prHypAction name="REWRITE7" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p27"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p29"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prHypAction name="HIDE4" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p30">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p30" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p31,p32,p33">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_count_arr{book ↦ count})(b)" org.eventb.core.prHyps="p32">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p35,p36">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_total_arr{book ↦ count})(b)" org.eventb.core.prHyps="p36">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p35,p37">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p37"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p31">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p39">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p33"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p35">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p42">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p31" org.eventb.core.prInfHyps="p40"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p38" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p31,p38"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p43">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)(r)" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p43">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p42">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p42" org.eventb.core.prHyps="p42"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p44,p45">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p36"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p46"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p44" org.eventb.core.prHyps="p35" org.eventb.core.prInfHyps="p47"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p48"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p44,p49">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p32"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_total_arr{book ↦ count})(b)" org.eventb.core.prHyps="p49">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p35,p50">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p50" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p51"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p51"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p35" org.eventb.core.prHyps="p44" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p48"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p44,p52">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p52" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p53"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p53"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p53" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p54"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p54"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p31">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p39">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p38"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p33"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p55">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)(r)" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p55">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p39">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p39" org.eventb.core.prHyps="p39"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p54" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="count≤count"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p53" org.eventb.core.predicate="book_count_arr(b)≤({book} ⩤ book_total_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="(book_count_arr{book ↦ count})(b)≤(book_total_arr{book ↦ count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p51" org.eventb.core.predicate="book_count_arr(b)≤count">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤count">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="count≤(book_total_arr{book ↦ count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="count∈ℕ1"/>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="prior=waiter_priority(b)∧(book_count_arr{book ↦ count})(b)≤(book_total_arr{book ↦ count})(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="count≤({book} ⩤ book_total_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="¬⊤"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧(book_count_arr{book ↦ count})(b)≤(book_total_arr{book ↦ count})(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="¬book∈available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p55" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="book∈BOOK"/>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="waiter_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="book∉available_books">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="book∈BOOK∧count∈ℕ1"/>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="waiter_priority(book)∈READER ⤔ IDS"/>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="prior=waiter_priority(book)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="waiter_priority(book)(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤(book_total_arr{book ↦ count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="⊥"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="count≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="r∈dom(waiter_priority(book))">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p52" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤({book} ⩤ book_total_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r10" org.eventb.core.prRID="org.eventb.core.seqprover.falseHyp"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
<org.eventb.core.prProof name="add book copies/inv9/INV" org.eventb.core.confidence="1000" org.eventb.core.prFresh="r,b,prior" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="p1,p2,p3" org.eventb.core.prSets="BOOK,READER">
<org.eventb.core.lang name="L"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p4" org.eventb.core.prHyps="p6" org.eventb.core.prInfHyps="p5"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p7" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p8,p9"/>
<org.eventb.core.prHypAction name="REWRITE1" org.eventb.core.prHidden="p10" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p11,p12"/>
<org.eventb.core.prHypAction name="REWRITE2" org.eventb.core.prHidden="p13" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p15"/>
<org.eventb.core.prHypAction name="REWRITE3" org.eventb.core.prHidden="p16" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p17,p18,p19"/>
<org.eventb.core.prHypAction name="REWRITE4" org.eventb.core.prHidden="p20" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p14,p21"/>
<org.eventb.core.prHypAction name="REWRITE5" org.eventb.core.prHidden="p5" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p22"/>
<org.eventb.core.prRule name="r2" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="type rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p23"/>
<org.eventb.core.prHypAction name="HIDE1" org.eventb.core.prHyps="p24"/>
<org.eventb.core.prHypAction name="HIDE2" org.eventb.core.prHyps="p11"/>
<org.eventb.core.prHypAction name="HIDE3" org.eventb.core.prHyps="p14"/>
<org.eventb.core.prRule name="r3" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="∀ goal (frees r,b,prior)" org.eventb.core.prGoal="p0" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p25">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prRule name="r4" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⇒ goal" org.eventb.core.prGoal="p25" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p26,p27,p28">
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_count_arr{book ↦ book_count_arr(book)+count})(b)" org.eventb.core.prHyps="p27">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p30,p31">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_total_arr{book ↦ book_total_arr(book)+count})(b)" org.eventb.core.prHyps="p31">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p30,p32">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p26">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p28" org.eventb.core.prInfHyps="p33"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with b=book" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p30">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p37">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p26" org.eventb.core.prInfHyps="p35"/>
<org.eventb.core.prHypAction name="FORWARD_INF1" org.eventb.core.prHyps="p33" org.eventb.core.prInfHyps="p36"/>
<org.eventb.core.prHypAction name="DESELECT2" org.eventb.core.prHyps="p26,p33"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p38">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(book)(r)" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p38">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p37">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p37" org.eventb.core.prHyps="p37"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p39,p40">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p31"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p40" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p41"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p41"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p39" org.eventb.core.prHyps="p30" org.eventb.core.prInfHyps="p42"/>
<org.eventb.core.prRule name="r1" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="simplification rewrites" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p42" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p43"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p39,p44">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p27"/>
<org.eventb.core.prRule name="r5" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="ovr in (book_total_arr{book ↦ book_total_arr(book)+count})(b)" org.eventb.core.prHyps="p44">
<org.eventb.core.prAnte name="'" org.eventb.core.prHyps="p30,p45">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p45" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p46"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p46"/>
<org.eventb.core.prRule name="r0" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="generalized MP" org.eventb.core.prHyps="">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p30" org.eventb.core.prHyps="p39" org.eventb.core.prInfHyps="p43"/>
<org.eventb.core.prRule name="r10" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="⊥ hyp" org.eventb.core.prHyps="p43"/>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prAnte name="(" org.eventb.core.prHyps="p39,p47">
<org.eventb.core.prHypAction name="HIDE0" org.eventb.core.prHyps="p44"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p2">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p47" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p48"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p48"/>
<org.eventb.core.prRule name="r9" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="Functional image simplification in hyp" org.eventb.core.prHyps="p3">
<org.eventb.core.prAnte name="'">
<org.eventb.core.prHypAction name="REWRITE0" org.eventb.core.prHidden="p48" org.eventb.core.prHyps="" org.eventb.core.prInfHyps="p49"/>
<org.eventb.core.prHypAction name="SELECT1" org.eventb.core.prHyps="p49"/>
<org.eventb.core.prRule name="r6" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="eh with prior=waiter_priority(b)" org.eventb.core.prGoal="p29" org.eventb.core.prHyps="p26">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34">
<org.eventb.core.prHypAction name="FORWARD_INF0" org.eventb.core.prHyps="p28" org.eventb.core.prInfHyps="p33"/>
<org.eventb.core.prHypAction name="DESELECT1" org.eventb.core.prHyps="p28"/>
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p1">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p50">
<org.eventb.core.prRule name="r7" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="functional image goal for waiter_priority(b)(r)" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p50">
<org.eventb.core.prAnte name="'" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p34">
<org.eventb.core.prRule name="r8" org.eventb.core.confidence="1000" org.eventb.core.prDisplay="hyp" org.eventb.core.prGoal="p34" org.eventb.core.prHyps="p34"/>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0.0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="1"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
<org.eventb.core.prString name=".pos" org.eventb.core.prSValue="0"/>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
</org.eventb.core.prAnte>
</org.eventb.core.prRule>
<org.eventb.core.prIdent name="IDS" org.eventb.core.type="ℙ(ℤ)"/>
<org.eventb.core.prIdent name="book" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="book_count_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="book_total_arr" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="count" org.eventb.core.type="ℤ"/>
<org.eventb.core.prIdent name="waiter_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
<org.eventb.core.prPred name="p1" org.eventb.core.predicate="waiter_priority∈BOOK → (READER ⤔ IDS)"/>
<org.eventb.core.prPred name="p25" org.eventb.core.predicate="prior=waiter_priority(b)∧(book_count_arr{book ↦ book_count_arr(book)+count})(b)≤(book_total_arr{book ↦ book_total_arr(book)+count})(b)∧r∈dom(prior)⇒prior(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p49" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p39" org.eventb.core.predicate="¬b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p4" org.eventb.core.predicate="finite(READER)∧finite(BOOK)"/>
<org.eventb.core.prPred name="p33" org.eventb.core.predicate="r∈dom(waiter_priority(b))">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p48" org.eventb.core.predicate="book_count_arr(b)≤({book} ⩤ book_total_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p6" org.eventb.core.predicate="finite(READER)"/>
<org.eventb.core.prPred name="p17" org.eventb.core.predicate="∀r1⦂READER,p⦂ℙ(READER×ℤ)·r1∈dom(p)"/>
<org.eventb.core.prPred name="p44" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤(book_total_arr{book ↦ book_total_arr(book)+count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p11" org.eventb.core.predicate="∀r⦂READER·r∈READER"/>
<org.eventb.core.prPred name="p32" org.eventb.core.predicate="book_count_arr(book)+count≤book_total_arr(book)+count"/>
<org.eventb.core.prPred name="p2" org.eventb.core.predicate="book_count_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p10" org.eventb.core.predicate="∀r⦂READER·r∈READER∧card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p24" org.eventb.core.predicate="available_books⊆BOOK">
<org.eventb.core.prIdent name="available_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p9" org.eventb.core.predicate="init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p14" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK"/>
<org.eventb.core.prPred name="p41" org.eventb.core.predicate="book_count_arr(book)+count≤book_total_arr(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p5" org.eventb.core.predicate="⊤∧finite(BOOK)"/>
<org.eventb.core.prPred name="p12" org.eventb.core.predicate="∀r⦂READER·card(init_reader_loaned(r))≤max_loaned_books">
<org.eventb.core.prIdent name="init_reader_loaned" org.eventb.core.type="ℙ(READER×ℙ(BOOK))"/>
<org.eventb.core.prIdent name="max_loaned_books" org.eventb.core.type="ℤ"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p19" org.eventb.core.predicate="∀r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·¬p(r1)=p(r2)"/>
<org.eventb.core.prPred name="p20" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p22" org.eventb.core.predicate="finite(BOOK)"/>
<org.eventb.core.prPred name="p21" org.eventb.core.predicate="∀b⦂BOOK·init_total_books(b)≥init_count_books(b)">
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p42" org.eventb.core.predicate="¬⊤"/>
<org.eventb.core.prPred name="p18" org.eventb.core.predicate="∀b⦂BOOK,p⦂ℙ(READER×ℤ)·p=init_book_reader_priority(b)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p23" org.eventb.core.predicate="init_books⊆BOOK">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p27" org.eventb.core.predicate="(book_count_arr{book ↦ book_count_arr(book)+count})(b)≤(book_total_arr{book ↦ book_total_arr(book)+count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p16" org.eventb.core.predicate="∀b⦂BOOK,r1⦂READER,r2⦂READER,p⦂ℙ(READER×ℤ)·b∈BOOK∧r1∈dom(p)∧r2∈dom(p)∧p=init_book_reader_priority(b)∧p(r1)≠p(r2)">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p28" org.eventb.core.predicate="r∈dom(prior)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p26" org.eventb.core.predicate="prior=waiter_priority(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p50" org.eventb.core.predicate="waiter_priority(b)∈READER ⤔ IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p8" org.eventb.core.predicate="init_books=dom(init_total_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p45" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤book_total_arr(book)+count">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p13" org.eventb.core.predicate="∀b⦂BOOK·b∈BOOK∧ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p34" org.eventb.core.predicate="waiter_priority(b)(r)∈IDS">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p30" org.eventb.core.predicate="b=book">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p0" org.eventb.core.predicate="∀r⦂READER,b⦂BOOK,prior⦂ℙ(READER×ℤ)·prior=waiter_priority(b)∧(book_count_arr{book ↦ book_count_arr(book)+count})(b)≤(book_total_arr{book ↦ book_total_arr(book)+count})(b)∧r∈dom(prior)⇒prior(r)∈IDS"/>
<org.eventb.core.prPred name="p38" org.eventb.core.predicate="waiter_priority(book)∈READER ⤔ IDS"/>
<org.eventb.core.prPred name="p35" org.eventb.core.predicate="prior=waiter_priority(book)">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p15" org.eventb.core.predicate="∀b⦂BOOK·ran(init_book_reader_priority(b))⊆IDS">
<org.eventb.core.prIdent name="init_book_reader_priority" org.eventb.core.type="ℙ(BOOK×ℙ(READER×ℤ))"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p37" org.eventb.core.predicate="waiter_priority(book)(r)∈IDS">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p29" org.eventb.core.predicate="prior(r)∈IDS">
<org.eventb.core.prIdent name="prior" org.eventb.core.type="ℙ(READER×ℤ)"/>
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p40" org.eventb.core.predicate="book_count_arr(book)+count≤({book} ⩤ book_total_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p43" org.eventb.core.predicate="⊥"/>
<org.eventb.core.prPred name="p46" org.eventb.core.predicate="book_count_arr(b)≤book_total_arr(book)+count">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p31" org.eventb.core.predicate="book_count_arr(book)+count≤(book_total_arr{book ↦ book_total_arr(book)+count})(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p36" org.eventb.core.predicate="r∈dom(waiter_priority(book))">
<org.eventb.core.prIdent name="r" org.eventb.core.type="READER"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p3" org.eventb.core.predicate="book_total_arr∈BOOK → ℕ1"/>
<org.eventb.core.prPred name="p47" org.eventb.core.predicate="({book} ⩤ book_count_arr)(b)≤({book} ⩤ book_total_arr)(b)">
<org.eventb.core.prIdent name="b" org.eventb.core.type="BOOK"/>
</org.eventb.core.prPred>
<org.eventb.core.prPred name="p7" org.eventb.core.predicate="init_books=dom(init_total_books)∧init_books=dom(init_count_books)">
<org.eventb.core.prIdent name="init_books" org.eventb.core.type="ℙ(BOOK)"/>
<org.eventb.core.prIdent name="init_count_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
<org.eventb.core.prIdent name="init_total_books" org.eventb.core.type="ℙ(BOOK×ℤ)"/>
</org.eventb.core.prPred>
<org.eventb.core.prReas name="r2" org.eventb.core.prRID="org.eventb.core.seqprover.typeRewrites:1"/>
<org.eventb.core.prReas name="r6" org.eventb.core.prRID="org.eventb.core.seqprover.eq:1"/>
<org.eventb.core.prReas name="r9" org.eventb.core.prRID="org.eventb.core.seqprover.funImgSimplifies:0"/>
<org.eventb.core.prReas name="r0" org.eventb.core.prRID="org.eventb.core.seqprover.genMPL3"/>
<org.eventb.core.prReas name="r7" org.eventb.core.prRID="org.eventb.core.seqprover.funImgGoal"/>
<org.eventb.core.prReas name="r4" org.eventb.core.prRID="org.eventb.core.seqprover.impI"/>
<org.eventb.core.prReas name="r8" org.eventb.core.prRID="org.eventb.core.seqprover.hyp"/>
<org.eventb.core.prReas name="r1" org.eventb.core.prRID="org.eventb.core.seqprover.autoRewritesL4:0"/>
<org.eventb.core.prReas name="r10" org.eventb.core.prRID="org.eventb.core.seqprover.falseHyp"/>
<org.eventb.core.prReas name="r5" org.eventb.core.prRID="org.eventb.core.seqprover.funOvr:1"/>
<org.eventb.core.prReas name="r3" org.eventb.core.prRID="org.eventb.core.seqprover.allI"/>
</org.eventb.core.prProof>
</org.eventb.core.prFile>
